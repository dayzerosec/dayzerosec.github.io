{"hash":"ceb440c5702b23336e25cc45b18d2ba8e6e50683","data":{"post":{"title":"Episode 43 - Zoom E2E, 15 year old bugs, and killing 20 year old attacks","path":"/posts/episode-43/","date":"26 May 2020","date_iso":"2020-05-26","description":"A quick chat about E2E Crypto and Zoom, followed by a few noteworth exploits including Bluetooth impersonation, a 15-year old qmail CVE, NordVPN, and an RCE in Google. Ending with some mitigation research looking at making singlely linked lists safe, XSS prevention, and Code-Reuse Gadgets.","content":"<!--kg-card-begin: html--><iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/iNCr4kfZy7A\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<hr />\n<p>A quick chat about E2E Crypto and Zoom, followed by a few noteworth exploits including Bluetooth impersonation, a 15-year old qmail CVE, NordVPN, and an RCE in Google. Ending with some mitigation research looking at making singlely linked lists safe, XSS prevention, and Code-Reuse Gadgets.</p>\n<p>&nbsp;</p>\n<ul>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=57\">00:00:57</a>] <a href=\"/posts/adventures-of-porting-musl-to-ps4/\">Adventures of porting MUSL to PS4</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=122\">00:02:02</a>] <a href=\"https://github.com/zoom/zoom-e2e-whitepaper\">End-to-End Encryption for Zoom Meetings</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=803\">00:13:23</a>] <a href=\"https://www.chromium.org/Home/chromium-security/memory-safety/\">Memory safety - The Chromium Projects</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=1284\">00:21:24</a>] <a href=\"https://unc0ver.dev/\">First 0d iOS jailbreak in 6 years</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=1458\">00:24:18</a>] <a href=\"https://francozappa.github.io/about-bias/\">BIAS: Bluetooth Impersonation AttackS</a><br />\n\t<ul><li><a href=\"https://little-canada.org/pdf/web/viewer.html?file=antonioli-20-bias.pdf\">https://little-canada.org/pdf/web/viewer.html?file=antonioli-20-bias.pdf</a><br /></li><li><a href=\"https://francozappa.github.io/about-bias/talk/bias-snp/\">https://francozappa.github.io/about-bias/talk/bias-snp/</a><br /></li></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=2000\">00:33:20</a>] <a href=\"https://www.qualys.com/2020/05/19/cve-2005-1513/remote-code-execution-qmail.txt\">15 years later: Remote Code Execution in qmail (CVE-2005-1513)</a><br />\n\t<ul><li><a href=\"http://tukan.farm/2016/07/27/munmap-madness/\">http://tukan.farm/2016/07/27/munmap-madness/</a><br /></li><li><a href=\"https://cr.yp.to/qmail/guarantee.html\">https://cr.yp.to/qmail/guarantee.html</a><br /></li><li><a href=\"http://www.guninski.com/where_do_you_want_billg_to_go_today_4.html\">http://www.guninski.com/where_do_you_want_billg_to_go_today_4.html</a><br /></li></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=2888\">00:48:08</a>] <a href=\"https://www.thezdi.com/blog/2020/5/20/cve-2020-8871-privilege-escalation-in-parallels-desktop-via-vga-device\">Privilege Escalation in Parallels Desktop via VGA Device [CVE-2020-8871]</a><br />\n\t<ul><li><a href=\"https://twitter.com/matalaz/status/580600098092105728\">https://twitter.com/matalaz/status/580600098092105728</a><br /></li></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=3357\">00:55:57</a>] <a href=\"https://seclists.org/fulldisclosure/2020/May/37\">Multiple vulnerabilities in Dovecot IMAP server</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=3552\">00:59:12</a>] <a href=\"https://medium.com/csis-techblog/cve-2020-1088-yet-another-arbitrary-delete-eop-a00b97d8c3e2\">Yet another arbitrary delete EoP [CVE-2020â€“1088]</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=3996\">01:06:36</a>] <a href=\"https://hackerone.com/reports/767647\">Vulnerabilities chain leading to privilege escalation [NordVPN] </a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=4174\">01:09:34</a>] <a href=\"https://hackerone.com/reports/509629\">Race condition in activating email resulting in infinite amount of diamonds received</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=4350\">01:12:30</a>] <a href=\"https://www.ezequiel.tech/2020/05/rce-in-cloud-dm.html\">RCE in Google Cloud Deployment Manager</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=5304\">01:28:24</a>] <a href=\"https://medium.com/bugbountywriteup/qnap-pre-auth-root-rce-affecting-450k-devices-on-the-internet-d55488d28a05\">QNAP Pre-Auth Root RCE</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=5834\">01:37:14</a>] <a href=\"https://research.checkpoint.com/2020/safe-linking-eliminating-a-20-year-old-malloc-exploit-primitive/\">Safe-Linking - Eliminating a 20 year-old malloc() exploit primitive</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=6464\">01:47:44</a>] <a href=\"https://arxiv.org/abs/2005.08363v1\">Not So Fast: Understanding and Mitigating Negative Impacts of Compiler Optimizations on Code Reuse Gadget Sets</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=7550\">02:05:50</a>] <a href=\"https://arxiv.org/abs/2005.07826v1\">Precise XSS detection and mitigation with Client-side Templates</a><br />\n\t<ul></ul></li>\n<li>[<a href=\"https://www.youtube.com/watch?v=iNCr4kfZy7A&t=8280\">02:18:00</a>] <a href=\"https://portswigger.net/research/documenting-the-impossible-unexploitable-xss-labs\">Documenting the impossible: Unexploitable XSS labs</a><br />\n\t<ul></ul></li>\n</ul>\n<p>Watch the DAY[0] podcast live on <a href=\"https://www.twitch.tv/dayzerosec\">Twitch (@dayzerosec)</a> every Monday afternoon at 12:00pm PST (3:00pm EST)</p><!--TRANSCRIPT\n{\"transcript\": [{\"speaker\": 1, \"line\": \" Hello everyone. Welcome to episode 43 the day Zero podcast on Specter with me is and before we jump into the news. We're going to talk about how this is the last episode before we go on our summer break. So we're going to be coming back on September 14th, but we just wanted to kind of lead with that. That way you guys know, you know, when next week rolls around on there's no podcast. That's why we're coming back on the 14th. That being said, we're not going to be, you know, going off the grid. Few months. We are still going to be in the day Zero Discord and we might still do like blog posts and other content stuff like that. We're just not going to be doing the scheduled streams on the Monday's until we come back so that aside we can jump into some news we can get into Zoom. So we've covered zoom on this podcast before and actually I did forget we did want to do it showed up first. I had it moved in my notes. That's why I almost missed it. So I did actually do a blog post as well.\", \"start\": 9.5}, {\"speaker\": 2, \"line\": \" I put it out on Saturday the adventure supporting muscle to as for so I've been doing PS4 stuff working with the tool chain for building Homebrew and stuff like that. And one of the challenges that came with that was trying to bundle a\", \"start\": 64.7}, {\"speaker\": 1, \"line\": \" standard lib C because Sony customize their own Loop C and we don't have the\", \"start\": 78.7}, {\"speaker\": 2, \"line\": \" static Library. So we needed the port 1 I went with muscle and this blog post kind of goes into the challenges that I hit with like the ABI and stuff like that. And I think there's some interesting points in there for people who are interested in the lower level details talking about The kernel level and getting into sis calls and stuff like that. So people were interested in that might find that blog post interesting. So just kind of wanted to do like a self promo. I guess at the beginning of the episode where we get in this news because some of our viewers may find that interesting. Okay, so now we're going to zoom. So we've talked about Zumba for generally in a negative light. They've been struggling in the PR department over the last month or two. It seems Zoom is trying to change hearts and Minds though with their security stance and one of their one other steps in this process was they released a white paper around their encryption which they announced I think they announced a few weeks back. They were going to put this out and well here it is. They put it on on the 23rd. Yeah. Well, I think part of this that He has to do with you know them acquiring key base. As one of the first steps here. So I mean they did just acquire key base and then all of a sudden they're starting to look into using the public key crypto. Yeah, that's a good point. I don't know if they announced planning to do this because they advertise that they were and and quite a while back and that was something we kind of blasted them for last time. We were talking about Zoom. I want to say a week or two ago. I saw an announcement about it, but I didn't want to bring it up on the podcast because there was nothing really He said that was just we're going to be announcing this but we're not like we don't have any details at the moment. So I was like, okay, we'll just wait and see but yeah, I can't remember if that was maybe something else. But anyway, they put it this white paper. One thing we talked about when we talked with zoom in the past was they used the term end-to-end encryption when it's not really end-to-end because the key management is an end-to-end you rely on Zoom servers for that shared meeting key, which is then used to drive the session keys and to be fair. Are to them in this white paper. They actually they talk about that. They address it in the white paper. They acknowledge. The doing true end-to-end is pretty difficult logistically and they try to focus more of the security on the infrastructure to try to counter that I think they also had some weird statements on their AES key sighs. I meant to look back and see well, so they mention what they had kind of advertisers using AES 256 but was seeing was that they were using AES 128 that's That's what it was. So I think now they have corrected it they in the stock that they do mention the three using AES 128. So yeah, some of the things they do in this white paper, they talk about some background and a future roadmap for improving security. And the first thing they do is start out with outlining their goals and their threat model. So they consider any attackers that are like strangers to the meeting so they don't have meeting access information people who have meeting access information, but one To do something malicious as well as Insider threats all considered part of their threat model, which I think is pretty decent. I like that. They included The Insider threats angle on that too. It's expected. I mean it is what it is. Their threat model isn't very detailed at all. No a surface level. It's literally. Oh, I've got it up on string here like, you know, maybe a page if that's it's like this bottom third of the page and then the top third of another page. Yeah, that's their goals and threatened all that said I mean they do roll out with some details in their roadmap when they're talking about the different phases like pulling out the client Key Management. That's I had mentioned them moving into using more public and private key crypto. That's where they're kind of talking about that and their Phase 1 in terms of just introducing kind of that client manage Keys, which is a big step forward in terms of preventing people from intercepting any of that traffic and being able to modify. Zi read whatever is just having that client manage these yeah, they mention that the security here that they achieve just during that phase one is similar to what he get would like FaceTime or iMessage on Apple devices. Now one thing I did notice with phase one though is I think it's it's only supported on some clients. Like I don't think they're going to support like browsers dial-in stuff like that. It's mostly just like their native, you know, Mac OS and windows clients and stuff like that, but I think that's something that's just like just for phase one. I think they plan to address that in future phases. Yeah to some extent. I mean it is hard when you start dealing with like the public switched Network for calling in I mean you can't really do crypto over that. Yeah, but yeah, they do call out some of the limitations of what they're doing also and that's where I really think the key base acquisition might have been involved with writing this paper because it seems like suddenly they're taking some of the right steps when it comes to crypto. I mean want those right sets is just putting out that white paper putting out that information for people to be aware of how things are working. They're taking comments on this also until I want to say June 5th. And I mean giving this a quick read there was nothing that really stood out to me as egregiously wrong or anything. I didn't, you know, really dive into it and think about everything but nothing really stands out as being a problem assuming they implement. I things as they've written it here. It is. Definitely a very positive step. Yeah, I mean, I think they should be credited for the effort and willingness to at least like make changes and like you were saying the white paper. It's a good step. I did find some of their statements kind of I don't know if softball is the right word but like in their weaknesses section, they put a lot of the blame on other things. It's like, oh it's because these older devices or dial-in can support stuff and with our new stuff that we're going to be implementing. It's possible that identity providers can be compromised which we put trust in. It seems like their issue section specifically in their weaknesses focuses a lot on like stuff that's out of their control and not stuff that's in there control which I mean fair enough there still issues. It just seems kind of it seems like they kind of talked themselves up a little bit in this white paper. I don't know. I mean the things are pointing out though are legitimate trade-offs when it comes to okay, if you're going to support something that cannot support crypto. Okay, that's a limitation. They've called it out. If they allow if you use an SS if you sign in with SSO, so that's you know, a company providing their own identity provider. They do allow that identity provider to sign that this is part of phase 2, I believe when they focus on the identity. So your SSO provider, you know, some random company can provide their own SEO provider. I don't think they're wiggling out of anything by saying if your asses if your IDP Gets compromised then. Yes, it can sign fake identities or consign fakies. Yeah. No, I didn't mean it shoe. Like it's I don't think it's them trying to pass it off either. It's a trade-off. They allow you to control it. Therefore you're responsible for it or your company, whatever. I mean it. Otherwise, it's just we're the ones responsible. We're the ones that Like I think it's a net benefit to allow people to control their own signing authorities like that rather than only zooming able to and if it's only Zoom then they're responsible. So it's a valid trade off. I don't I wouldn't knock them for saying any of that because it's the trade-off of allowing other people to step in and kind of being a little bit more decentralized. Got turned off. I think like I was saying earlier I think phase one is probably the like biggest for me. Mostly because I remember one issue we're talking about before was the concern of Zoom servers being physically located in China and one of the problems with China is they the the Chinese government can force companies that have servers physically located there to hand over encryption keys that are stored on the server. So that was a major concern with having to rely on Zoom. Servers for that for those will be sharing so part of the issue there was when it seemed like some weird routing resulted in traffic going through with trying to server and that included a key suspense worked in China. Yes kind of had that weird result which seems like it was a bug rather than being an intentional thing. But but but that phase one taking, you know, some of that oh, yeah, it means even if that happens. Yeah, it's kind of like a It makes it so it's not even really an issue or it's not as much of an issue at least. So I think phase one is probably like the most interesting one there. Yeah. Well, I'm phase one's kind of where they introduced what would be considered more or less end-to-end encryption because the client controls the key the client can do the encryption and only the Only the targets able to decrypt using their own private key. Yeah. One thing I will say is weird though is you know, when you see white papers like this, you kind of expect some critique, especially you were saying like they were kind of looking for it. I was expecting to see some comments from like the crypto community and stuff like that because usually they like looking at this stuff and like tearing it apart. I couldn't really find any comments though by people looking at it. I don't know if it's just because it hasn't been out long enough. That's probably what it is. They're probably so like looking at it and they don't really They want to research into it more before giving any criticisms, but I don't know if you saw any but I couldn't really find like any comments on this from like I known people there is kind of the whole issue list here. They've got 16 open issues created with regards to and those are kind of the official comment on the paper. That's where they asked for comments to be posted under the issues list on their GitHub, but that's it. I did feel like there. I understand why they're rushing it does feel like it's a pretty short period but since they want to just get going with it and start implementing more secure crypto. I mean, it's definitely a short period for comments. At the same time, you know, they want to start with something and people can always create further issues. Anyhow, after the fact especially considering some of the negative publicity, I've gotten I think they want to be quick to remedy that which you know, they have gotten some good PR off of this and I think it's deserved. I think it's a good step. So yeah and just because we've been talking about that initial phase. One thing it is worth mentioning that one of the big issues with phase one. Is that basically Like a compromise server would still be able to inject private Keys into the meeting participants list. So there is still a fairly significant vulnerability there. That's something that they deal with later on but it is worth noting that there are there are still some issues like just because those keys can be compromised you just inject a key and then you can find out of everybody will be encrypting their content for you and just sending it to you. But that becomes then a very obvious step if requires an attacker to kind of actively do something rather than being able to passively eavesdrop. Yeah, it's more detectable and they try to deal with that through later phases. So chromium put out a blog post about their security specifically around memory safety though. They were talking about some high-impact bugs and chromium and the highlight of the post is talk about how many a high-impact issues are memory corruption related most notably use after free. So they said around 70% of high impact bugs are all memory corruption and 36% of those so half of those memory corruption bugs are use after free. Yeah, I found Like that to be quite a bit higher than I was expecting like thinking about it. I'm not that surprised by it, but it's still seeing the numbers laid out is still quite high or still feels quite high for just use after free. Yeah, I mean it's garbage collectors when it comes to browsers of always been kind of like there's so many edge cases and because of that you end up with a lot of potential use after fries with the garbage collector like a lot of the oh, yeah thinking about it. Like it makes sense. It's just, you know before actually seeing it laid out. I wasn't really thinking about it, I guess. Yeah. So I mean, this is quite significant. Talking about like the how many high-impact bugs are memory memory corruption when you're talking about browsers because code execution is generally very achievable when you're talking about browsers because of be just because of how complex it is. You can do a lot you can get a lot of Primitives and footholds when you're talking about memory corruption and code execution in the browser is a pretty powerful foothold. There is sandboxing and it's pretty good, especially unlike IOS and Android, but it's not If it gets an entry point that can be used by attackers to LPE and eventually compromise the system and mobile devices are a huge Target when you're talking about chromium, which is the base for Chrome. That's the default browser for Android. For example, though. This post talks about some of the solutions. They're looking at to try to combat memory safety issues. They don't go into too much detail. It's more of like a surface level list style overview of what they're trying to look into but a few of the things are looking at is like custom C++ libraries with garbage collecting or memory safety built in I won't mention your kind of getting to the technical details, but they do have one softer thing which is their rule of two which I thought was interesting. It's stolen right out of Star Wars by the way, but yeah, sorry, what was that? I didn't know that but effectively with their rule of to what they have is basically three rules, and any piece of code can violate two of them, but not three. So code which toad which processes on trustee inputs being one of those points code which runs with no sandbox another one and code written in and unsafe language such as C or C++ make another one. So you could write code for Chrome that violates two of those that's their rule of till which I thought was just an interesting approach makes sense. This time. Yeah, and I think it's doable like it seems like it's something they've already been doing like that. Yeah is it's a reasonable like goal though, like sometimes with some of these projects you see things that sound great in theory, but then in practice, it's like super hard to do when you what I'm saying is like that that's not even like that's not a doable like they're already doing that. That is the standard for a chrome developer chromium Developers. It's doing that like that's not something new. That's not one of the things that are researching. It's something they've already been doing for a while. Yeah, but they call it out here and they're sandboxing section before they get into kind of the things that they're looking at doing. So along with doing that they were looking into doing the custom C++ libraries relying on Hardware mitigations like memory tagging enforcing harsher checks through llvm like Banning raw pointers, which I think was the the point. I saw people bring up a lot. Well, that's definitely the one I thought possible I crossed. I thought was interesting to bring off because that's obviously A big part of getting the performance is not having the overhead now to be fair. Some of the pointer options are like the fat pointers. I guess you can call them are reasonably perform and also butt. I did it's an interesting statement. What I found kind of interesting about it is, you know, I have a friend who really likes doing C++ stuff and he hates see one thing. He's always said is with C++. You get a lot of memory corruption issues because of its Legacy ish support for see basically saying if you drop support for see you will end up with a more secure language, which it seems this is kind of a kind of a point that might add to that is, you know, bending raw pointers. One of the things that's been like being debated in the C++ Community is for C++ 20 potentially just dropping see support and one of those things might be like Banning stuff like raw pointers and stuff like that. So it's just kind of interesting to see how that could be like a supporting point for that. Overall. I think browsers are always going to be interesting in terms of how easy they are to hit enter it or not. How easy I should say how accessible they are to hit with their complexity and because of that it also makes it harder to employ Solutions like this. I think you probably need to mix these options. I don't think you could go like hard on one and then just call it a day. I think you know, you couldn't so I'm going to say that trust for example, I know he should migrate at all to Java that is one of the languages they mentioned so So I think you can migrate some of the code base to the safer languages when I mean that I don't think they're suggesting like they're going to do everything from they straight up say, you know just using safer languages plural anywhere applicable, which is you know, that doesn't sound like they have any sort of idea that they're going to implement everything all of wants its, you know piecemeal. Step by step and as appropriate. Yeah, I found they're bringing up of memory tagging a little bit weird because memory tagging isn't really something that is like specific the browser's or anything or the browser development stack that's going to be enforced by the system. So I swear like that you bring up the memory taking they say Hardware mitigation zi G Mt. E they always seem too much into it, but it just seems weird. Like that's that is something you would rely on if it was like available because it Be really strong. We've talked about memory tagging before but I do find it. I'm just not sure why they called it out specifically because it just seems like one of those things you would use if you had it available, but that's not something they can necessarily like influence too much without that work being done on the system level. So yeah, I just found that a little bit weird, but they don't go too in depth on any of these points. It's more of like a what they're looking into bullet point style and they have like a little Spectrum here of like lower cost. Less Improvement higher cost more Improvement and you know moving the safer languages as on the higher cost side and then doing some of the spatial safety, which I think they said they're already doing some of already is on like the lower cost. I think overall though this blog post it's cool to get some insight into where they're looking at and the stats can always, you know, when the numbers are laid out you can get some insight that otherwise even though it might be obvious. It's just it doesn't hit you the same way and I think that's what you were kind of saying zi was like It kind of jumps out at you. How common use after fries are in browsers? Yeah. I mean, like I said, it's not that surprising thinking about it, but I just had really thought about it. Yeah, it's just a good highlight. So there was a jailbreak released last week for iOS uncover for iOS 13.5. So unfortunately, we don't really know anything about the exploit details because it is a zero-day exploit, but I did want to bring it up. Up in the new section. Just because not only is it an IOS Jailbreak which we do see like a few of like we check we talk about check right not too long ago, for example, but what makes this one unique is it's the first zero-day IOS Jailbreak in six years, I believe I think the last zero day jailbreak was iOS 8 with I want to say pangu was the name of the jailbreak that was zero day. I haven't tried it myself. But I've also heard this jailbreak is remarkably stable. Like there's not many people that are having like I've And I was Joe breaks in the past where you literally had to run it like a hundred times before you got the successful. Jailbreak. You just Kernel Panic like every retry until you did it like a hundred times. This one seems to be like it's pretty stable. So this is some pretty big news because it's as not only is it a zero day jailbreak? But it's also pretty stable and when you're talking about zero day exploits that are stable going out there. I guess there is kind of a debate you could have with the Epic simple, like implications of it, you know, if there's like a malicious threat actor out there, for example that reverses the IPA figures out the bug and then uses it before Apple gets around a patching it now there is kind of that that interesting question there. I don't know if you have any thoughts on that zi. Hey mean it comes down to When one of the issues is going to be just what the bug is. Does it require installing an application. It does require installing the IPA. Well, so any that implemented that might be a choice that they're making in terms of how they're Distributing it, but whether or not you actually need to do that for the ex white would make a difference in kind of the ethics of it. I think that's it. Ultimately. It comes down to your enabling people to do what they want with their devices. And in order to do that that does mean that malicious attackers can also potentially take advantage of that. But I'm generally kind of in favor of the jailbreaking in general. Yeah, I mean obviously I that was more of like a devil's advocate position. I do PS4 jailbreak, so I'm not going to be a pot calling the kettle black. I haven't dropped zero days, but you know what? I mean? I'm generally I like Joe Bruno you prefer like what 950 days old exploits. Yeah bringing up that joke, but yeah, like generally I like to bring I think this is really cool. I might actually spin up my iPad which I haven't used in like a year and and check it out. But you know if there's any As users in the audience and what they've probably already heard about this, but you know, just wanted to give it a little bit more traction with that said though. We'll move into some exploits that we have our weekly named attack. We have bias this one targets upon know what was our who tooth authentication was our last named vulnerability. I mean you're saying weekly so I mean the last I can't even remember when the last one was but feels like it's been a couple months. It's been a few months. So it might not have been like last week, but I don't know so our bimonthly okay. Our bimonthly will say that so this one targets a vulnerability in the Bluetooth authentication mechanism, which allows anyone that exploits it to impersonate any Bluetooth device. So this was presented on May 18th at the IEEE Symposium on security and privacy. This is pretty significant because Bluetooth is used in like pretty much everywhere. Well supports Bluetooth the big thing. Significant here is also that this is a standards-compliant attack. This isn't really a vulnerability in the code. This is a vulnerability in the standard itself where it's just Wrong effectively a logic bug because the way it ends up working is so normally secure authentication between the two devices. You've got like that pairing key. It's a long term key use between the devices. So then when you want to attend to Kay with the master device, so whatever like your stereo or something that has Bluetooth how or Third music console like a control. Yeah called. So there's I mean every a lot of thick support Bluetooth, but um with the master device if you want to authenticate with a usually you're going to do this challenge response based authentication based around that pre-shared pairing key what ends up happening with this attack though is when the attacker presents itself. So some of the attackers a slave actually I kind of the easier case to thing boat is The the mess they're doing the impersonation. So we'll start off with that case. Let's say you're going to pretend to be whatever device the slave devices connecting to what it will do is it will downgrade it will just say like hey, I don't support this secure authentication and let's use this Legacy connection and said basically like there's no enforcement. So even if both devices support, The secured authentication you can just choose not to use it. Anyhow, and the master can just be like no, here's the Legacy if indication challenge instead. So what happens with the Legacy a 10K challenge the issue is that the only the master really does any authentication or validation on it? Oh, so you send off any challenge you want to the slave device and just accept whatever they send if you're the master you can just accept it and don't actually do any validation since a slave doesn't actually do any validation. You can impersonate any Master Just By ignoring what their responses on the other hand. If you want to impersonate your own device to be someone else you can present as them and then before you get the authentication challenge, you just send a rule switch command over to the master device. You're like no I want to be the master of this connection. And then then you can just send the challengers off to the new slave the old master and continue as normal because now the attacker the slave has become the new verifier of it. And like I mentioned the downgrade aspect is kind of a second Biff an issue. Just having to do with fact that there's no Integrity being checked on that negotiation for what type of identification to use and there's no for support like even if they both support the secure one, they neither party actually has to use that sound like you're going to ask something Specter. No, I was going to say it seemed like that was the core of the issue is that it wasn't enforced that both parties had to use Guess the authentication if one tried to use it what was no like Mutual when I was like the Legacy at the indication is just one-sided. That is the Legacy at the end occation. Only the master doesn't he? Only the master does any validation of the client? Okay, that is just what the Legacy. I have their there is a proper name for it. I've only written down LSC. So unfortunately, I know that's Legacy. I want to say secure authentication, but I've not exactly sure if that's the proper name for the protocol there, but So, I mean, of course the issue had to come down to a legacy authentication mechanism. One thing I will say though is I found kind of interesting that I can't think of the last like big Bluetooth attack that can be exploited on in scale like this. Can you I don't know if I'd seen um, and it's so actually these guys put out a paper last year also knob. Which was another thing the knob is broken X playing low entropy and the encryption key negotiation of Bluetooth. And this is last summer. Yeah, August 20 19 So they have personally even had other attacks going out. This one I think is significant largely because it is kind of Standards compliant and just like an issue at the design level it seems Yeah, and it's an issue that can affect like countless amounts of devices because yeah, they mentioned every device they've tested as vulnerable. Yeah, not surprised or was vulnerable. They did proper some are they did practice some proper disclosure on this kind of bring it out to the industry before disclosing this publicly. So I did think knob was a was done by a different team, but I guess I was wrong because I remember seeing something on like Twitter or something where the guys behind naming bias were like, oh, we didn't know this was already named knob or something like that. So maybe I don't know maybe that was a joke or something because I thought they were done by two different teams though breeding this here. It's the same names under knob and bias, so I'm not sure maybe that was just some like me getting something confused there. So thank you for pointing that out because I was going to say that there were two different things but they're not well they are different things. I personally teams. I mean, oh, yeah that said, I believe you can also change knob with this for some further attacks. I don't know enough didn't dig into this enough to actually comment on what those were but it is it is possible to chain the to when attacking instead of doing the Legacy attack or in Sophia's not legacy protocol using the Our or in theory more secure an action like if you assumed. Yeah it basically if you just assume that there was a secure connection. They were still able to break things. Before we move on it's worth noting. They do have a white paper, but it is pretty pretty heavy. If you're not if you don't have a background in Bluetooth, like you're going to need to do some research into the background a Bluetooth the totally understand it. Some of their diagrams are are pretty, you know, they just they require a lot of background knowledge. So because I was going to try to go into the nitty-gritty details and tried looking at the white paper and I'm like, yeah, I'm too dumb. Yes, their presentations actually pretty pretty easy to understand. It's 11. It is long from the conference. I don't know. I'm on the wrong page. I was trying to say I don't see it here, but I was looking at the iOS exploit. I don't father one thing. It's Center talks. Hmm. That is nice. Doesn't look like it at least not the link. I was wanting to find but so maybe that's something we can add in the description is a link to the video where it's not on the site there. Yeah. I mean it should be here. Yeah, no, I guess we'll just have to add it later. But there is it's like 11 12 minutes long gives a pretty solid overview of the attacks. So keeping on the topic of older bugs, we have a 15 year old bug found in qmail. Actually there were multiple bugs. I think there was this was one of three vulnerabilities discovered in 2005, but they were never fixed because they were believed to be unexplainable turns out they were wrong though. This this little qual says security advisory goes into an integer overflow in the stir Alec ready plus function, which I believe is called when reading lines of a mail message and if we go down, Let me just go down to where the bug is. So on line 23 there. They have XA that their variables here aren't really very descriptive. But they add they have a base and then they add and then add and shifted by to the right by 3 and then store it in a field and then they call a function which will allocate and copy data into a newly allocated buffer, but it allocates with that calculated size, but the copy happens with just the original XA from line 21 for those who are watching so Basically you end up with a discrepancy between the sides. It's allocated in the size. It's copied and because of that you get an integer overflow which can lead to buffer overflow. So if you send a message with a header line, which is 4 gigabytes, for example, which is what they use you can copy four gigabytes of data into a buffer that gets an allocation size of 512 megabytes for example, so this is yeah those sizes kind of matter here because this does take advantage. I mean, it's based on like the 32-bit size. So you need to kind of get that value going over the four gig limit or the roughly four gig limit? So this is kind of tricky to exploit right? Because you're talking about these large sizes and you need to get an allocated chunk adjacent to the Target chunk because if you have unmapped memory in between you're going to crash though, assuming you can do that which they did manage to do with some keep things. Shoot me with the you know, length of the message header lines. It's basically they do a heat metadata attack and it's one that I actually I haven't really seen before that's probably just do to like, you know, just me, it's probably like a known I'm not sure if you've seen it before zi. Yeah, I've seen him it's been around like it's relatively new I think and Mama, I mean it's Sorry, they include that's what I'm trying to think of. There is a no, there isn't a house of name for it. It's very similar houses. I'm sorry. I can't remember what I want to say. It's House of worse. I want to say it's really similar in it. At least I can see a relationship between this and House of force. It's definitely not House of force like it is different from that. But just in the sense of getting like kind of an arbitrary point. Our by the large allocation. So the way this one works is through the am on math effectively you're able when you overflow want the chunks that's going to get freed. You said one of the bits in there saying is MF. So it's why I think it's worth. I think it's nmap when it's freeing. It's going to on map it and you also control the size that it thinks the block is so you control the size that's going to unwrap so you can basically have it on map everything until you start hitting like where lipsey is loaded. And then from there you do another the next header as it's reading kind of line-by-line. The next header should be very long and the exact size of that unmapped region so that it gets the allocation there. Where now you sir controlling the data that gets written into it and there they actually do include a link to a reasonable reasonably good write-up about that about the attack. So that'll be in the description out of town. We do have one question. From Taylor gal. I probably butchered that but is is that the compiler actual source that is actual Source. They says DJ be Barren scene. I'm not sure if the pronunciation they're reasonably. Well, no one actually died for his work. He's I believe he's on like the NASA land ACL crypto Library team stuff fairly well-known in crypto communities rho Q mail and you know as you can guess coming up with crypto kind of a math background math people like to write these source that he's single letter variables. I mean, I don't know if that's why he chose at this time. It is worth noting like this was written in 97 like the last release of qmail was 98. So, I mean there are Forks, but the last release of his code. Sorry, you'll know what I will note like how they hit that first page. The first page is of Lipsy. Basically what they did is because qmail the client is partial rho. It's not full read-only relocations. They basically just overwrite the addresses for lips he functions so they chose open and they just wrote an arbitrary dresser to get code execution. Yeah. That's a good point like one. I mentioned just kind of getting that start of lib C being there. What in particular what's important there is yeah, you do have the relocation table and stuff right at the start. So that's what they were targeting not executable code. Yeah, and because it was partial relative. Wow, read only. I know I Rel wear whatever. Yeah, that's such a weird thing to say to weird combination. But um, yeah, that's the gist of the issue I do. To jump back a little bit unless you have more to say about the issue itself specter. I was just going to say the other thing they said was even though it wasn't full row and their attack relies on it being only partial they do say that this strategy wouldn't work if it was full row, but you could potentially hit it a different way. It's not like guaranteed to be on exploitable still. Yeah. Yeah. Go ahead see. Yeah. Well, I want to talk a bit more about the meta here, which I thought was more interesting. So obviously this requires a lot of memory to exploit so when this was first reported, back in 2005 by going to ski it was basically rejected as Yeah, nobody's going to run qmail with four gigs. And if you look like Debian right now ships him with a 7 megabyte limit. So needing for gigs is quite a big ass. And it's worth noting I mentioned how like the last release Here was 98 it still looked at because of this the qmail security guarantee and this has been updated I think. Yeah, so now there's also a thousand-dollar prize but he's been offering a $500 prize mentions it still stands. This has been updated a few times like this is the current page makes mention of this the May 2005 claim that 64-bit portability problems allowed a remote exploit in qmail SMTP D. This claim is denied. Nobody gives gigabytes of memory to each qmail smt be Process so there's no problem with Q males assumption that allocator railings fit comfortably into 32 bits. It's kind of the official response to it. So they admitted to there and then like no it's not a security issue. I definitely disagree there. I mean that's basically saying well you can configure it securely therefore it not a security issue. Whereas that's just kind of like a Band-Aid over the fact that there is an issue. You always had a skate away from yeah, it definitely does and to be fair. He has paid out on some issues not with qmail though. We did pay out on the DJ be DNS back in 2009. so like he has paid out on some of the issues but under this one definitely feels like he's skiing off. So one important thing to note here is cuales what they found also was that well, yes, the SMTP D service was heavily Limited in terms of the size of would read are like that memory if you get you couldn't get that for gigs the qmail local. Was is still remotely a hittable and was not limited in such a way. It would just use whatever memory so it is remotely exploitable in a default setup of From I believe they use Debian. Yeah, go on top of that issue. They also covered some other issues towards the bottom ones. They didn't really go through with exploiting but they just kind of point out so they had one that was a logic bug which made it so it would accept unqualified mail addresses as valid because it fell back on a hard-coded default domain when not given a domain and then the other one was an information disclosure where you can test for the existence of files in an attackers home directory. And that's because qmail verified doesn't drop privileges before it does something there that those details were a little bit vague. I was kind of struggling to see and that's just because they kind of tacked it on at the end of those issues exist, and they didn't really look into them but it's worth noting that they are there. So, you know, if you're if you wanted and some of the other shoe stay found if your interests there is also kind of the original advisory back from 2005 which goes into kind of the issue. We talked about and a secondary issue. ew You could tell just by looking at that site that it's from 2005. You wouldn't even need a time stamp on that definitely the black and green. Takes me back black and green Manos spaced. No. Well, that's yeah, I mean that's got to be does this use frames no frame. So okay. It's little bit better. Oh, hey, but yeah, how is that will be down in the description there? No background music. I was disappointed. No, that's more that's a little bit earlier in the mm. That's more like 99203. Well, I guess my space. I tell but I feel like my space is kind of special, you know, most websites were doing that anymore that point but my space definitely was fluffs in chat says 94. Yeah, I wasn't quite on the internet then so I can't can't think back to it. But Seems about right we met but yeah, I do still want to talk a little bit on the qmail security guarantee here though. Okay, at least I don't know. What are your thoughts here? Like would you agree with me in saying that seems like he is trying to kind of weasel out of just paying the or at least back then actually now to because it is Do I have I think I have his actual response here now. Just a bi we're looking for it. I mean II would agree with that that it seems like he's trying to skate. Oh because he never said that it had to be exploitable in like a default configuration. It just said exploited to take over another account which you can do. I mean that well so he does set some context like you can't find issues in like the file system or TCP or DNS or something. I'm like issues that are on the system that are external to cumulate qmail where this is directly in qmail. It's just they kind of got lucky in the way that it's not hittable easily because of that limit, but I generally I agree with you. I think that this seems like he's trying to skate away from from Hangout for the issue. Yeah, I mean, so my first thought actually was like, okay last release in 98 and then they have an issue in The five like, you know, it's dead already whatever but it's not dead. It's still used. It does say my offer still stands. So yeah. Yeah. So the you know, it's still going even though it's old. So yeah. No, I just I wasn't familiar with this offer until kind of looking into this a little bit. So it did it did seem like that was kind of the general consensus because I did see some drama around this from like info site people. I follow on Twitter saying, No. You know, there is all this like security guarantee and it's like okay and issues been found. I'm just going to ignore that like it says that it did seem to rub people the wrong way. So sorry were you going to ask? No? No, that's right. Nothing really to add. I guess. It's That's more or less kind of my thought on it is. When it comes down to it, it's an issue that should be fixed. It should have made the Assumption especially now as people are using 64-bit a lot more frequently. I mean, I don't think it's a fair assumption to think. Okay. Well, it's you know, everybody's going to be 32 bit even back then. I don't think that would be a fair assumption to make in general with your code is just do the check. What was that old Bill Gates saying that nobody will ever use more than half a megabyte of memory or something like that. This is one of those things that's like not going to age. Well, basically that's that's what happened back then it's like this is not going to age well and yeah, I remember thinking I had so much room on my floppy disks floppy that those even exist anymore. Are they still made there? So I actually was in a situation using one not that long ago. Light board that was using what you could load cues on and off it with a floppy disk. Wait, what's that like life like for controlling like stage lighting? Oh fair enough, okay. Military. Yeah, this is floppies. They're you they're still still uses for it. Technically speaking floppy disks are more resilient than hard drives, aren't they? Like they can like not to make more if they survive longer not the magnets. But like I don't know. I don't know the stats on that. I don't want to say for sure. I just said feel like it's something I've heard. Anyway, we'll move on to zi. So zi another zi zi favorite people they have a write-up on Virtualization stuff though. It talks about one of multiple bugs found by Renault Robert in a virtualization program called parallels, which to be honest. I haven't heard it before but it's a mac program. So if you don't use Mac probably don't run into it. Yeah, so it specifically in the VGA subsystem which isn't super surprising. I feel like I've definitely heard of other bugs and DJ before I do like how they found it. I do like this fuzzing phone. Yeah awesome fuzzing code. So, you know, there's people who spend hours and months into writing fuzzers smart fuzzers with like code coverage and all this stuff. This father is literally just pick a random number and throw it at a port and this would be a great place to bring in that comic. Yeah, you know the one I know that's not XKCD out of otherwise, I'd be able to find a whenever I want ya know. I don't know who it's from. Yeah. It's basically it was like two people talking like I spent like three days writing this father and I found like bugs I'm really happy in this is other guys think was wrote this father and two minutes and I found five I think was like writing a static analyzer and is more involved than that but there's probably people out there know the top the comic we're talking yeah I'm actually looking to see if I have have it here but it doesn't look like I have it readily I'd always loved LinkedIn IRC not too long ago but it's too far back I'm not gonna be able to find it within a few minutes unfortunately but yeah it's literally it's it's a case in point of that it's like you can just find stupid issues by dumb fuzzing sometimes especially in like older subsystems like VGA though when they root cause the issue they found with fuzzing they found it was an out of bounds right in the screen buffer so one thing you can control with these ports or they're basically they're kind of like memory-mapped registers basically you can control the with the sequence see the sequencer data register it's the screen width and height and these values are Pounds checked so when the video worker thread goes to get a new width and height for the screen to update the screen buffer it overflows when it's writing data to it. And because this you know, the length of the Overflow can be decently controlled because of how much control you have over the width and height they assumed it was likely exploitable and it did turn out to be now. One thing they did have to do which they didn't mention until really late in the post. I'm not sure why is there's a flag in a shared object called in VGA state. Which sets whether or not you're allowed to earn that you are updating the screen buffer information. So it has to be set for to true for you to be able to update the screen buffer width and height, but it has to be set to false for the out of the Bat Out of Bounds right path to be taken and because this buffer is in shared memory between ring zero and Ringo 3 it can be modified with that select Port I mentioned earlier and there's basically a double fetch bug there. You can flip the flag in between to work around the constraints so that you can update it while the flag is true and then also access it while the flag is false. So how they patch that. It's a basically move that flag from the state which could be updated from the port they move that to a context which is controlled and ring 3 from the host I believe and it can't be double fetched anymore. So that's towards the end of the blog post. I think they probably should have had that a bit higher because that is pretty important to the issue, especially considering that's how they fix the issue, but that is you know, just just too\", \"start\": 82.9}, {\"speaker\": 1, \"line\": \" Like that, that's basically what the core of the issue is that ability to double fetch there.\", \"start\": 3098.2}, {\"speaker\": 2, \"line\": \" Yeah. I mean it's that ordering was a little bit weird when it came to kind of reading this. That said I mean the issues reasonably straightforward. I think\", \"start\": 3103.1}, {\"speaker\": 1, \"line\": \" otherwise, yeah, unfortunately, they didn't really go into the exploitation details and just kind of showed here. No when I guess found here's the root cause and then they kind of stop there. I guess\", \"start\": 3115.0}, {\"speaker\": 2, \"line\": \" this is also just how was reported to them also like it was just reported as that fuzzing script and in chat matheus and Ruby both kind of pulled up. The comic itself. So I've got that up on screen\", \"start\": 3125.2}, {\"speaker\": 1, \"line\": \" now. Yeah. So for people listening it's the first slide says, I wrote a vulnerability scanner that abstracts all the predicates and a binary traverses the call graph and generates formula it to run them with a smt solver. I found one vuln in three days with this tool and then it so that it has another guy and it says he wrote a dumbass fuzzer and found five bones in one day good thing. I'm not a noob like that guy.\", \"start\": 3139.7}, {\"speaker\": 2, \"line\": \" I mean it it's it is so true though. I mean fuzzing is based. It's an unreasonably effective. I know years ago people were thinking that you know will fuzzing would kind of be like format string issues where issues found with it are going to be pretty rare once kind of all the issues have been found but fuzzing has just kept producing. and Sullivan dumb\", \"start\": 3163.7}, {\"speaker\": 1, \"line\": \" fuzzing it is kind of accurate and it's obviously funny. What I will say about that though is with dumb fuzzing. You're only really going to find surface level issues on the problem with that is if your fuzzing something that's being fuzz by a lot of other people you're probably going to end up with a lot of collision. Whereas when you're doing smartphones and you're probably going to end up finding deeper issues that are you're not going to catch with them fuzzing and those issues are probably going to survive longer and they're going to be more interesting bugs me. Likely, they're not going to be low hanging fruit. So what did he Stars though? This\", \"start\": 3189.5}, {\"speaker\": 2, \"line\": \" is a smartphone this kind of comparing less smart fuzzing and more like just Von scanning and static analysis doing the smt solver and\", \"start\": 3224.9}, {\"speaker\": 1, \"line\": \" stuff. Yeah, but I just wanted to highlight the yeah Fair Point don't like we're not saying that like smart fuzzing is useless or anything, but it's\", \"start\": 3234.2}, {\"speaker\": 2, \"line\": \" just the oh no smart fun thing is very useful and so is the vulnerability scanning like there's definitely a place for that but it's just, you know dumb fuzzing is unreasonably effective.\", \"start\": 3242.7}, {\"speaker\": 1, \"line\": \" Yeah, going back to the zi zi post. It's always nice to see write-ups talking about virtualization. This code while it is D compilation and whatnot. It doesn't look like great code at a glance. So it's not too surprising. There's other issues here because they mentioned that the researcher that submitted this bug said that there were other issues that just weren't disclosed in this post this issue specifically though is kind of funny because I had this exact type of issue with a PS4 tool chain. Sample, actually, we had a sample that Drew x to the screen through the screen buffer. So it's just CPU rendering. It's not like complex GPU rendering or anything like that. And you know, when you're dealing with fonts and writing text you have to do adjustments on each like character, right? Because otherwise you're going to have text that looks real weird because you have to account for the Baseline and everything. So when you're doing that you're going to be making adjustments on the X and Y coordinates of where you drop from with the CPU and If you were like really close to a screen Edge when you were drawing that text those Transformations could actually go at a balance of the screen buffer and we ended up with out of bounds rights actually like very similar to what happens here. Not quite because this one is a little bit more involved with like changing the width and height, but it's kind of funny that it's it's kind of similar in a way so I could kind of sympathize a little bit. What the what the code authors on this one. But yeah, just kind of a funny comparison there, but overall I think it was a good blog post, but I think it could have been ordered a little bit better. But still I love seeing virtualization stuff. So with that said they will move onto multiple vulnerabilities and of cats IMAP server, though, this details three bugs three seems to be a magic number. I think we have like three topics that have three vulnerabilities in them today. But this one is in the IMAP server. So it's internet message access protocol. It's used for accessing email on remote web servers and stuff like that. The issues themselves are pretty straightforward though. First issue is sending a malformed new command. Which noop is like a Keepalive command if you send a malformed one, you can cause a crash\", \"start\": 3255.2}, {\"speaker\": 2, \"line\": \" so I'm just going to stop here and say that you say no op really\", \"start\": 3385.3}, {\"speaker\": 1, \"line\": \" weird. Oh, is that what it is know what?\", \"start\": 3388.4}, {\"speaker\": 2, \"line\": \" Okay, I believe that snow off. Yeah.\", \"start\": 3392.3}, {\"speaker\": 1, \"line\": \" Okay. No op fair enough make sense. Usually when I say when I see no opposite a space or a dash or something separating it. Yeah. Well, so it's technically like because\", \"start\": 3394.6}, {\"speaker\": 2, \"line\": \" it's it's another one of those line protocols. So I just commend argument. type the elf so they don't include those characters, but ya know\", \"start\": 3403.8}, {\"speaker\": 1, \"line\": \" Walt maybe we should just put hex 90 there that would have that would have made me say it the right way. That would be inaccurate. Well, yeah, but it would have made it sound better. So the second shoe is sending a command with enough new lines triggers a use after free. I honestly I can't even speculate on what would cause this they don't have a root cause here they just have like surface-level bug details. Yeah, that's definitely how sending new lines triggers at\", \"start\": 3414.0}, {\"speaker\": 2, \"line\": \" uaf. Well, so that's going to come down. Like I said, it is a line based protocol. So new lines are separating all the commands. So my guess would be since I do mention a sufficient number. They probably have some Offer some some set that once you go over that buffer number, it starts reallocating the old ones or trying to reuse some or perhaps it overflows and index some I would imagine something like that such that once you entered enough new lines, it'll overflow and then I'll start trying to reuse things that already existed there. Yeah, something like that. They don't like us\", \"start\": 3441.6}, {\"speaker\": 1, \"line\": \" the information of her kind of thing.\", \"start\": 3477.2}, {\"speaker\": 2, \"line\": \" I don't know. I don't know what's implemented as so I don't want are making claims They Don't Really include much. It's just sufficient number of new lines. So I'm going to say at least two new lines are needed. That's probably that is that is as far as I\", \"start\": 3480.6}, {\"speaker\": 1, \"line\": \" will go. Fair enough and the third issue is scenting sending mail with an empty quoted local part causes a denial of service. So if you send an email with like a sender recipient with a blank user at domain, you can cause a crash. So yeah those first two issues like even the no op1 it seems kind of weird like I don't really know how those could exist. It's hard to speculate the third one probably seems more reasonable as to why that would break assumptions. It'd be interesting to see the code behind this. That being said like, you know, like you were saying there's not too much detail here. It's mainly just like surface level details on each\", \"start\": 3496.1}, {\"speaker\": 2, \"line\": \" bug. But yeah, I just figured it was no horthy. I mean dovecot isn't exactly unheard of or a rare piece of software to be used.\", \"start\": 3533.1}, {\"speaker\": 1, \"line\": \" So Up next we have arbitrary file deletion through Windows error reporting. So the issue here is pretty straightforward because it's a bug we've seen in Windows a lot before it's been we've been seeing tons of them crop up ever since James for shot talked about it. Like\", \"start\": 3542.1}, {\"speaker\": 2, \"line\": \" well, I want to say this is like our third one that we've talked about in windows are reporting this year was sorry not this year like in the last 12\", \"start\": 3560.6}, {\"speaker\": 1, \"line\": \" months. Yeah, so essentially the issue comes down to how are reporting handles event traces when they get written to a temporary file and appdata\", \"start\": 3572.2}, {\"speaker\": 2, \"line\": \" eventually I will mention that it's maybe the traces its everything that's entered in this Dynamic etw sessions registry. It has several entries in that and those reflect folders that are then vulnerable to this attack. So he happened to have that but he doesn't actually know. It fills in these Registries. So your system or system. You're targeting may use something different. he just makes mention of the registry here that gets added. Yeah, so it's whatever that sorry I keep interrupting you, but it's whatever that name is this case. It's this one trace and your case. It may be something different. I just wanted to point that out keep going.\", \"start\": 3583.6}, {\"speaker\": 1, \"line\": \" Yeah, essentially the issue there is in that folder that gets created it tries to rename the file from dot buff da TT L to Da TT L when the when it tries to flush the event race, but if that fails they delete the file and from there. It's an issue. We've seen a lot before it's a classic symbolic link attack by crashing an application and turning the parent folder into a mount point. You can basically delete any file on the system with the same privileges as Windows error reporting so patch for this which is system. Yeah, which is system. So the patch for this is a basically implemented a new delete file method called util delete file path, which implicitly checks the file to make sure it matches the expected path. There is also a little bonus excerpt At the beginning or at the end of the article in that flush buffered function that handles the delete. There was also a potentially more powerful primitive that could allow for arbitrary copy of file into a privileged folder and that's because they call move file W before delete file W. So in that window, you could link the link the folder to like a privilege system directory and then move something like a dll for example into that directory and pull-offs like a dll. Hijack, which Thing that we something like the attack that we covered by ins coup. And what's in the after I think I I'm sorry, if I got the wrong well, but they did a similar attack the other week like last week or the week before.\", \"start\": 3630.2}, {\"speaker\": 2, \"line\": \" Yes. So we've like the first time we talked about one of these so the episode was when your heirs have airs, I don't recall what the episode number was. But that one we kind of go into detail of one of those sorts copy attacks same sort of attack in windows are reporting involving the\", \"start\": 3723.0}, {\"speaker\": 1, \"line\": \" copy. So in May Microsoft out of the new function to the are reporting code base which creates a random file and a path and locks the folder. So it seems like they're they're trying to secure Windows error reporting because I think this blog post mentions there's been ten reporter than 20/20 alone. Windows are important. I\", \"start\": 3744.4}, {\"speaker\": 2, \"line\": \" just pulled it up. That was episode\", \"start\": 3765.9}, {\"speaker\": 1, \"line\": \" 13. Okay. Wow, that was a while back. That was like back was that when we came\", \"start\": 3767.6}, {\"speaker\": 2, \"line\": \" back from that was when we came back. It was exactly go\", \"start\": 3773.0}, {\"speaker\": 1, \"line\": \" back. Yeah. So yeah. Lots of Windows are reporting which I guess is as a little bit of irony so over the years, there's been so many of these symbolic link and Junction attacks that they're no longer even considered in scope of Microsoft's Bounty program. Because I think they're working on it like what that function. I just mentioned that like locks the folder. They're trying to work on it, but I don't think they're going to be paying out for any like newly submitted issues for this stuff and that that's fair like when you get such a high volume of bugs because of something so trivial. I think it's fair that they don't like keep pouring money\", \"start\": 3776.3}, {\"speaker\": 2, \"line\": \" into yeah, at least as long as they are working on that. I do think that's fair. I mean that is one of the challenges I recently was talking with somebody about like, you know, why Do some companies have a vulnerability program, but then they don't actually pay anything and I mean that kind of comes down to the maturity of the software and I mean obviously Microsoft Works item to have reasonably mature software and reasonably mature practices in developing it but I do think this is one of those cases where it's so common there is a solution that they just need the time to go through doing that. I do think it's fair if they stop paying out for them.\", \"start\": 3816.8}, {\"speaker\": 1, \"line\": \" I don't know dirty researchers. Want to do bug bounties for t-shirts?\", \"start\": 3853.0}, {\"speaker\": 2, \"line\": \" You know what? So I I mean in so if you want to get into that discussion, like I think it's fair or for companies to not have a bounty especially when they're first getting started if they do have bad code that's not obviously not having a bounty isn't going to encourage a lot of people to test but at least they have a program. So those interested in testing, you know can report and have no issues and then as their program matures they deal with those low hanging fruits. They're not just going to be bleeding money. If the Bounty they can start offering actual money or some companies just never officially offer money, but do still pay out for bounties there. You just don't commit themselves to paying out. All\", \"start\": 3857.4}, {\"speaker\": 1, \"line\": \" right, as long as it's clearly outlined that they're not like, you know doing any payouts or anything. I think it's fair.\", \"start\": 3899.6}, {\"speaker\": 2, \"line\": \" Yes. No, I'm just adding a bounty\", \"start\": 3907.3}, {\"speaker\": 1, \"line\": \" is it's\", \"start\": 3909.1}, {\"speaker\": 2, \"line\": \" part of its part of the maturity process of a security program. You know bad code is written especially early on people aren't thinking about it. You know, they mature they add the bounty in after they've had some time to mature. Like I think it's completely Fair. It is a bit more inexcusable. When you do have these large companies, like I know want the first kind of L rages that I self the community was with a Yahoo, but Sonia things down like there are I think IBM I don't think they pay outing bounties. There are definitely some big names that should be paying out bounties. That should have a mature enough program that don't.\", \"start\": 3911.4}, {\"speaker\": 1, \"line\": \" But bottom line with the Microsoft one is they're not going to be paying for those low hanging fruits anymore. So, you know, you probably might want to start looking for something else. You're if you're in the windows\", \"start\": 3954.9}, {\"speaker\": 2, \"line\": \" area well, so if you wanted to look for this type of issue anti\", \"start\": 3965.0}, {\"speaker\": 1, \"line\": \" virus,\", \"start\": 3969.9}, {\"speaker\": 2, \"line\": \" that would be what I that's where I would start looking. So that's where you're still going to be able to get those privilege escalations and some of them do still pay out\", \"start\": 3970.4}, {\"speaker\": 1, \"line\": \" though. There's probably even lower hanging fruit issues in the anti viruses. They're pretty terrible. But yeah, that is something you could keep on your radar. So we talked about Nord VPN a decent\", \"start\": 3979.8}, {\"speaker\": 2, \"line\": \" amount like we talked about him a few times. That's the end of last year. We were really talking about them. Yeah, actually because of that Kili.\", \"start\": 3991.9}, {\"speaker\": 1, \"line\": \" Yep. So here we have a hacker one report that was partially disclosed. Now. This is I think this is the first one we've ever covered that's only been partially disclosed and it's about a chain of five bugs that allowed privilege escalation in the Mac OS client. There's not many details because it's only a limited disclosure but Reading the summary provided by Nord by chaining all five of them together. They can create a next PC connection with a privileged helper kind of like that adobe bug we covered last week. This is extremely similar to that issue actually and then they can send a message to the binary opened at a controlled location with a symlink and that's symlink can then be raced by swapping it with a malicious file and you can get Nord VPN to execute as file as root Yeah. So basically the exact same attack as the Adobe Reader issue, I\", \"start\": 4000.8}, {\"speaker\": 2, \"line\": \" think yeah. Yeah. Yeah. Well, it was Acrobat Reader. That was last week. Yeah, and this one it seems like it's supposed to be executing Nord VPN like actual Nord VPN binary. That's what you're racing, which is very similar like Mensch to the last week one where I was trying to up to run the\", \"start\": 4048.0}, {\"speaker\": 1, \"line\": \" updater. Yep,\", \"start\": 4065.2}, {\"speaker\": 2, \"line\": \" but yeah, I know we don't have all the details but it's something\", \"start\": 4069.5}, {\"speaker\": 1, \"line\": \" I was a little bit surprised about any pay it was a little bit lower than I thought it would be $500 then again. I didn't look at Nord VP. Like I can't remember Nord vpns payout threshold. So, you know, maybe that's within one of them.\", \"start\": 4075.1}, {\"speaker\": 2, \"line\": \" Yeah. Well that that is within their High\", \"start\": 4086.2}, {\"speaker\": 1, \"line\": \" payout. Yeah so fair enough so we can't see comments or any like zi details, but I think it's reasonable to expect just because of how similar this issue was to the Adobe one. It's possible that the researcher that reported this issue saw that adobe like right up and then tried it on or VPN and discovered they were vulnerable to it as well because this was only disclosed on the\", \"start\": 4088.2}, {\"speaker\": 2, \"line\": \" 22nd. Like this was only just closed but it was reported five months ago.\", \"start\": 4111.0}, {\"speaker\": 1, \"line\": \" Okay fair enough,\", \"start\": 4116.6}, {\"speaker\": 2, \"line\": \" so I don't yeah. I don't think they had access to the Adobe wine, which would have just been released. He's publicly the way maybe but\", \"start\": 4117.5}, {\"speaker\": 1, \"line\": \" I don't think it's reasonable to expect that. No, I that's a fair point. I guess it's just a coincidence. Like that's just weird that like two weeks like back-to-back we get issues that are\", \"start\": 4130.7}, {\"speaker\": 2, \"line\": \" yeah. I mean, they don't have to be some reason why people start looking that that those XP connections there were just like that kind of world that I mean there could have been some reason why multiple people started looking at that really, I'm not sure when the Adobe one was Actually reported. I know we covered the discovered it as it's disclosed, but as it's reported, I'm not\", \"start\": 4141.6}, {\"speaker\": 1, \"line\": \" sure so keeping on the hacker one train. We've got a race condition in activating email which results in infinite power. No infinite amount of diamonds received in the Forge of Empires game and the registration process. Basically when you register you get 50 in game currency for confirming your email and you can guess where this is. Given by the title being raised condition the link to confirm the email would increment the currency count before actually setting the email is verified. So if you sent a bunch of requests in parallel, you could get more in-game currency than you should have been able to this. This is like an issue that we've talked about before this reminds me of like there was a similar issue in CTF platforms where you can submit Flags multiple times before they were marked as completed. In the CTF platform, so we definitely seen issues like this in the past but I will say this is the first time I can remember seeing it affecting microtransactions and games though. As this has more of like a financial impact than\", \"start\": 4163.5}, {\"speaker\": 2, \"line\": \" some it has a financial impact on the microtransactions. I mean, the issue itself is just confirming your email like it that's the action which isn't really microtransaction related. It just happens to have that impact. No\", \"start\": 4227.8}, {\"speaker\": 1, \"line\": \" anti anti game currency. Yeah, like people won't be buying Microtransactions if they exploit this issue or they'll be buying less like yeah. It's the first issue like this that I can see having Financial\", \"start\": 4240.3}, {\"speaker\": 2, \"line\": \" impact with OKC. So I've so it has existed also in like Cloud platforms and spinning up certain machines you can or it's been possible to do this sort of attack. Oh, so there have been some very expensive cases of this sort of thing are potentially expensive. in some\", \"start\": 4253.2}, {\"speaker\": 1, \"line\": \" cases Okay. So yeah, it's very straightforward issue. This issue was reported last year, but it was just this closed last week about a parrot was pretty high though. He got a $2,000 Bounty paying for this I guess because of that Financial impact probably though, you know more than I expected but it\", \"start\": 4275.0}, {\"speaker\": 2, \"line\": \" looks like that is their critical rewards. Yeah, that's fair. Yeah,\", \"start\": 4293.4}, {\"speaker\": 1, \"line\": \" but it's fun to see race conditions. I mean, I love seeing it in web. Yeah. Yeah. Yeah in web like outside of binary. It's fun to see races. I mean I love races in binary to\", \"start\": 4298.0}, {\"speaker\": 2, \"line\": \" but yeah, I mean but see binary feels binary feels so much different than what you see in the web where it's quite often. The web wants are.\", \"start\": 4307.8}, {\"speaker\": 1, \"line\": \" It's\", \"start\": 4318.3}, {\"speaker\": 2, \"line\": \" usually like some event that's only supposed to happen. Once you have happened multiple times. Like the race is kind of different when you're dealing with the race conditions in like\", \"start\": 4318.6}, {\"speaker\": 1, \"line\": \" they're more time to check time of\", \"start\": 4327.8}, {\"speaker\": 2, \"line\": \" use. Well, you've still got talk to when it comes to the binary stuff to I don't know if it feels different to me. I kind of I have a soft spot for these.\", \"start\": 4328.9}, {\"speaker\": 1, \"line\": \" So we move on to an are seeing Google clouds to ployment manager. So this seems to be another thing coming out of Google's vrp vulnerability research program. So zi, I'll let you take this one away because I didn't get to this one too much. I was getting a lot of notes on the other topics. I didn't get to read this one as thoroughly as I would have liked.\", \"start\": 4342.1}, {\"speaker\": 2, \"line\": \" Yeah. I mean this one is kind of it's a little bit ramli, but I thought it was interesting nonetheless as it all timidly. So the end result is a Thirty-three dollars and 37 sent Bounty payout huge one of the maximum especially on more for web type issue. It was reported just as being a server-side request forgery to Google's internal Services. Although it's believed that it could be used for remote code execution. Although they don't actually provide enough information about actually doing that and Googled and provided either they report as SS RF and it got bumped up in a Two minutes to RC and was treated as an actual incident. So what ended up happening here and this is obviously the links will be in the description and it's probably worth giving it a read. They spend a little bit extra a good bit of time kind of I won't say rambling. It's related information giving a lot of background here. That isn't necessarily I needed to understand the issue. But what ends up happening is obviously as they're doing their research, you're trying to find like hidden or internal type. So Google Cloud deployment manager lets you create like a deployment script of sorts. I've never used it. So unfortunately, I can't provide a lot of details on that but um, You can Define your deployments over how I met resources and it can handle creation deletion. It's like scripting it off. Basically you provide like a python script for it or leave I want to say they offer some other templating method to Jinja templates, maybe not entirely relevant. But as I mentioned there are a kind of\", \"start\": 4359.5}, {\"speaker\": 1, \"line\": \" types and that that you can\", \"start\": 4469.5}, {\"speaker\": 2, \"line\": \" Define one of the first things they're looking forward just like are there any hidden or internal types which they did in find, but they do Some things that they looked for and one of the things they did though, they meant create deployments with a template that would return an exception on any operation which I thought was just an interesting technique to expose information off times. I've reported when an application may be has overly verbose error messages. It includes like the whole stack trace and stuff and this is just a good example of where that actually matters where they're able to cause an exception and they don't show an actual example of what they were seeing with it. They just kind of make mansion. That they base worried create this deployment that every operation that Google would do would cause the exception so they can see hey this except happened on like this python line and see all of the libraries being you see all of this internal information and started looking into\", \"start\": 4471.7}, {\"speaker\": 1, \"line\": \" that which\", \"start\": 4532.0}, {\"speaker\": 2, \"line\": \" was interesting. They didn't go anywhere with it. But again, it's one of those things just kind of point out because it is a very valuable tactic to be aware of Ultimately wind up happening is they noticed on their metrics page? They noticed some undocumented API versions. So if you've use Google Cloud platform at all, you're able to kind of provide.\", \"start\": 4534.4}, {\"speaker\": 1, \"line\": \" In the\", \"start\": 4557.6}, {\"speaker\": 2, \"line\": \" domain, you'll provide like what API version 2 you so commonly you might want to use like something beta feature. So that would be on like a separate domain compared to the main API in this case the else came across Alpha which I've seen exposed a few times and it's sometimes in documentation. One thing that is seen or I've never seen it and I don't think should have been exposed. I might be mistaken, but that is done. Dog food, which is another endpoint which happens to be used or is use within Google for internal testing and enlisting the types on the dog food. He found there's this Google options field on everything which let them it had various fields and I like injecting a project delete intent. There's a whole list of them. He didn't go and figure out what a lot of them were did figure out like ownership kind found some values for a transport only found this unknown transport type and Harpoon various things like that. But what was interesting\", \"start\": 4557.9}, {\"speaker\": 1, \"line\": \" is released no worthy as GS and\", \"start\": 4622.4}, {\"speaker\": 2, \"line\": \" lib, Target or gslv Target, which is the global Service load balancer. So you're able to set a load balancer Target for your deployments and I will also mention that he uses at one point Proto protobuf over HTTP, which I wasn't aware of has an option for interacting with the Google Cloud platform. But essentially you can send yeah. Yeah why they do have it. I just wasn't actually aware of it. But yeah, you can communicate over a pro using protobuf. Stead of like normal HD. Well, it is still over HTTP but instead of doing like the Jason you can use protobuf. What was interesting with that is these these fields that had a numeration types? So he was able to find like unknown user in Google for ownership kind since their genomes when you do it over when you do the Jason, it's expecting you to send this actual name, but when you send it as protobuf, Oh debuff just uses the numeric value. So he was able to iterate over the possibilities and get what the actual get would all the possible values were by just enumerating over 2T enumeration type, which I thought again was interesting and that's where he came across the transport actually had a GS lib support for it. Trying to find it\", \"start\": 4625.4}, {\"speaker\": 1, \"line\": \" here. One thing I'm curious about is for protobuf. You you need a you need a so protobuf basically is a compiler. It takes a definition file. So you give it like a, you know list of structures and stuff like that and you pass it to the compiler and it generates bindings for whatever language you want to use. So, you know, we have like C sharp python stuff like that. So what I find interesting here is instead of just like going over the enumerated type shouldn't those types be directly in the Protobuf like Library files but out by the compiler because those should have provided some\", \"start\": 4715.8}, {\"speaker\": 2, \"line\": \" I don't like I don't think releasing\", \"start\": 4753.5}, {\"speaker\": 1, \"line\": \" information. You know what I mean?\", \"start\": 4755.9}, {\"speaker\": 2, \"line\": \" I don't believe he had access to that at this end. I was kind of the serialized data. Yeah,\", \"start\": 4758.4}, {\"speaker\": 1, \"line\": \" but you would need that to serialize that that of those that's why I'm just I'm kind of wondering like\", \"start\": 4765.8}, {\"speaker\": 2, \"line\": \" well, you can kind of figure that out on your own though, too. Because you know what the Jason is, you know, what's kind of being expected there you do get the list. So you do know like it's a string and it's an integer and yellow sorts of values. So you would be able to figure that out. Okay. I'm at least he doesn't make any mention of having access to that.\", \"start\": 4769.8}, {\"speaker\": 1, \"line\": \" Anyway, so you finally if he did have access to that it would be kind of like Justified really want to look at it would provide a lot of good information it would\", \"start\": 4790.0}, {\"speaker\": 2, \"line\": \" but I imagine any that would have been provided like if we will does provide it would be using the public API not this dog food one because this whole Google options is definitely an internal thing like it's not supposed to be exposed. Okay. But anyway, what do you end up finding there? Was this GS a live as one of the transport option. So creating something GS live is the transport option and set thing that sorry, I keep saying Jesus lab but the GSL be and setting the Target that we had already pointed out by setting those use a to serve making internal request to Internal Google services basically and that's at the point where he submitted a VIP ticket which was triage and the basic said we need to look into this a bit. And I think it's so RC. So they converted it from the ticket just into a proper bug upgraded it as I mentioned. I think earlier B zi p 0 SC AR o treated it as you know, a proper incident and paid out the 31,000. bounty\", \"start\": 4797.7}, {\"speaker\": 1, \"line\": \" So obviously given that payout it is a pretty high impact bug but one of the other things is like near the beginning you were saying, there's they provide a lot of background information even to the point where it's not necessarily needed to understand the issue and that's one reason to shout this out to is, you know, getting that information from like people's experience reversing and just playing with stuff gives some really nice background knowledge that. You otherwise would probably struggle to obtain if you're trying to like break into an area. So that might be worth checking out just for like the background information alone, even like leaving the issue aside.\", \"start\": 4867.9}, {\"speaker\": 2, \"line\": \" Yeah, I mean it's there's some issues when it comes to like what information to include in a write-off or versus just being very concise.\", \"start\": 4906.5}, {\"speaker\": 1, \"line\": \" You want to strike a balance.\", \"start\": 4915.1}, {\"speaker\": 2, \"line\": \" Its if I don't I don't feel like this one really strikes that balance. It's too much. I feel like it's too specialized I guess to like specific. I don't know. It's I mean, like I said at the start I do think it's worth reading if you're interested in this but at the same time, I don't know. I it's not like I don't think it's an amazing right off that said I will also mention that they do believe like the RC possibility does come from one of the exposed services. Like service or like the deployment managers delegator. So like the service account believe that's where they think you might be able to get the code execution from he be able to get some tokens. But they don't actually have the details on all of that.\", \"start\": 4916.5}, {\"speaker\": 1, \"line\": \" The one thing that seems nice with vrp is if you look in the disclosure timeline, for example, and I think this isn't the only case I think we've seen other cases like this. It's just you was only like reported and fixed this month. I think it was reported on like the fifth and then our sorry no the seventh and then it was fixed on the 20th and we're hearing about it. And when was this post published? It wasn't today? It was it was to publish the 21st. So one day after it was fixed. So like when you're looking at like hacker one and stuff like that a lot of those reports. A lot of them. It's like months or even up to like a year or two years between the issue being fixed and you actually like being able to see it like it hitting public disclosure with VR P. It seems like as soon as the issue is fixed. Google doesn't mind you talking about it. So that is one thing like that. I do kind of like with vrp is I like being able to like get the detail like, you know, maybe that's just selfish of me but I do like being able to see the details as soon as it's fixed kind of thing, especially for something like Google Cloud where it's you know, Like people need to patch things. It's all done on the cloud.\", \"start\": 4973.4}, {\"speaker\": 2, \"line\": \" So yeah what that's kind of I think doing it what the key difference is when you've got some like Google when you've got a live application you're able to like you update you fix this and it's fixed for everybody. There's no delay. Everybody gets patch of the same time. So like nobody's vulnerable anymore. Everything's good. It's definitely very different when we're talking about applications that do need to be updated. I get kind of having a little bit of leg. Time that said a lot of things on hacker one are very similar. They could be fixed immediately for everybody and they are fixed for everybody and they still just don't allow disclosure. That's actually something else thing. But when we were talking about hack was it hacker one, there was some controversy at maybe was bugcrowd. I feel like it might have been something with hacker one something got reported and then they rejected it and then they full disclose the finder full disclose that and people weren't happy about that and I feel like you know somewhere like hacker want they could sever the pushing for Pushing for companies to have those public disclosures disclosures like I do think if they had a system where it's like you join hacker wind. Okay, you don't have to disclose things. You can still hold back on it, but then they had to encourage like\", \"start\": 5036.7}, {\"speaker\": 1, \"line\": \" okay in one year time. You have\", \"start\": 5116.5}, {\"speaker\": 2, \"line\": \" to be disclosing say quarter of all of your reports. How many kind of working people towards having greater disclosure? Like I feel like hacker one would be in a really good position to start enforcing that better practice by encouraging companies to mature their process rather than just keeping them wherever they want wherever they're\", \"start\": 5119.6}, {\"speaker\": 1, \"line\": \" at. Yeah, yeah, they're in that kind of position taking a question to chat Razzie. Woo the reward of thirty one thousand three hundred thirty seven dollars is a very specific number always wondered what goes under the siding such an amount Google vrp payouts are always going to consist of one Threes And Sevens. I'm not sure why it's kind of cheesy, but I guess it's basically they're like their way to Watermark. I guess the Bounty payouts so you'll see like $137 or 1337 dollars or 13,000 $337 like it's Is going to be one of the it's always going to include 1 3 3 7 and if possible so, that's why you see 3 1 3 3 7\", \"start\": 5139.9}, {\"speaker\": 2, \"line\": \" so like you do recognize that that's leaked. Right? Like yeah, okay, because you didn't mention that nothing like you do know that number right?\", \"start\": 5178.4}, {\"speaker\": 1, \"line\": \" I do think I do think it's like that is silly that they do that though. Like, I\", \"start\": 5189.9}, {\"speaker\": 2, \"line\": \" mean, that's kind of like, in fact that number still came out back when Google still had the sorry. When I say that number like that is a bounty from Google was still like a thing back when they still had like that. Don't be evil or whatever tagline along still asleep. But they don't have that anymore origami,\", \"start\": 5193.6}, {\"speaker\": 1, \"line\": \" but how long has it been since they since the\", \"start\": 5215.2}, {\"speaker\": 2, \"line\": \" Google Bounty? I don't know. I'd have to go look that off. I feel like it's been quite a while that said my point was more. I feel like Google was a different company when that started. I always still kind of\", \"start\": 5217.4}, {\"speaker\": 1, \"line\": \" that. It wasn't corporate sized all the way.\", \"start\": 5231.0}, {\"speaker\": 2, \"line\": \" Yeah. Yeah. So like the fact that they use leet at the time and Lead was also a little bit more common. Used to used to I don't think just generally more. Yeah, neither do I wear as you know in the mid-2000s? It still was\", \"start\": 5235.2}, {\"speaker\": 1, \"line\": \" it was all the rage.\", \"start\": 5253.8}, {\"speaker\": 2, \"line\": \" So like that's where I came out of it. I don't know. I think it's just a cute thing. They do I made it. I like it. I don't think they decided that's actually worth that and not you know $36\", \"start\": 5255.2}, {\"speaker\": 1, \"line\": \" instead. Yeah, I mean it's kind of silly but it also it is kind of like that that like embedded Mark I guess like if you see a payout that ends with three three seven, you know, it's of the RP payout like there's no other Google pizza p yeah. Yeah, so it's kind of its kind of like a watermark and the Bounty payouts would just kind of\", \"start\": 5269.7}, {\"speaker\": 2, \"line\": \" neat. That's what I mean. It's not like they need a water Market Bounty. They don't\", \"start\": 5289.9}, {\"speaker\": 1, \"line\": \" look no one but you know, that's that's a benefit. It's a therapy thing.\", \"start\": 5294.8}, {\"speaker\": 2, \"line\": \" Yeah, actually I have seen some other companies do that. I could have named them offhand, but it I have seen\", \"start\": 5298.3}, {\"speaker\": 1, \"line\": \" it. Okay. So getting into qnap. This one is our third article going into three vulnerabilities this one in qnap photo station and CGI programs for their Network attacks toward not attacked network attached storage. So these vulnerabilities all affect qnap nass models, they affect all of them. So the first issue is their video API exposes an endpoint called caption which will export the file contents of a given file name from a get or post parameter and this name isn't checked. It just has a straight-up directory traversal which can allow you to get an arbitrary file read now. Normally this would be an issue but you would need some level of access to hit it because you need to be able to access that that That endpoint and that endpoint requires you to have access to an album like you need an access code to that and but the problem there is the API allows you to create sample albums, which will return an album ID and it will set an authentication code on your session and because of that you can get an on-off think on authenticated local file read. So this can be abused to also get an authentication bypass for later exploits because photo station creates a magic file, which can contains a login In for the app user which is like the default user which is in Etsy config app token. But while this token is encrypted, it's also cashed somewhere else in share multimedia thumpy esta tapped token. So you can then steal this plaintext token to be able to authenticate as app user and that's kind of important because the other issues are behind that additional like authentication checks. So you need that authentication bypass. The the second issue is a PHP injection bug in the TP settings in the control panel for setting an email probably to send like images out to or whatever upon like uploading images this email. This e-mail field doesn't have any filtering you can straight up just inject PHP code into the session. So another low hanging fruit issue and then the third issue so you the first you\", \"start\": 5304.7}, {\"speaker\": 2, \"line\": \" inject the PHP code, but you still need to be able to execute it like having PHP code in the session is Nothing, and I believe that's still a valid email. Like I always I always hate it when I don't know for sure. I believe that is a valid email. I can't see any reason why it wouldn't be unless the angle brackets possibly. I don't think those are valid email I think is right if you well I emails very very open for missing and I hate it when places try to be smart with validating their emails. Just send the email. Because I get rejected because like I have to sub domain or like I have a sub domain actually not even using two of them in place will be like, nope. It has too many dots\", \"start\": 5431.1}, {\"speaker\": 1, \"line\": \" in it. Many dot will\", \"start\": 5482.0}, {\"speaker\": 2, \"line\": \" basically yeah, it will reject it because of the subdomain there or\", \"start\": 5485.9}, {\"speaker\": 1, \"line\": \" that's a little bit too much.\", \"start\": 5491.2}, {\"speaker\": 2, \"line\": \" Well, there's or because I have a dashing it is another really common\", \"start\": 5492.5}, {\"speaker\": 1, \"line\": \" one\", \"start\": 5496.6}, {\"speaker\": 2, \"line\": \" so silly so I don't necessarily blame them for not checking for PHP code in the email. It's going to send and if it bounces it\", \"start\": 5498.8}, {\"speaker\": 1, \"line\": \" bounces, so you disagree with that being an issue.\", \"start\": 5506.9}, {\"speaker\": 2, \"line\": \" This can be used to get an issue. But so the later is she though is being able to well one control kind of where the session or the sessions I'm getting written to a location. You can control. And that I believe is an issue just having PHP code in the session won't execute anything as window like that does get set apparently in the session itself. But this next issue that comes up it will do this file put contents. Then it will have this music station session path and it creates a session file name based on the session ID and it encodes a session right to it. Which also isn't strictly speaking a huge issue under most circumstances. It seems like a really weird feature to have because PHP does do this automatically it's saves the assess underscore session ID files is well by default. It saves them in slash temp. So I don't get why they're manually saving sections. I it seems like it's related to the sound because this is in that sample album code again. So it seems like it's probably relate to that. I probably understand more if I was familiar with the application, but it's a fact they write that and then the fact they don't validate that session ID at all. So because that session ID is just based off of your session token like the cookie you can set that to any value you want including a tree traversal so you can Traverse your way out of that session area and save your own file. And so if you set the path to something like, you know the web root and a PHP file, it's going to save your session including that PHP code you injected elsewhere. It's going to write that out to a DOT PHP file, which will then execute So the issue comes down one is trusting the session ID the other issue I think though and it isn't actually mentioned here. Is what they should be doing is on a new session. You don't trust the session ID that users give you your you shouldn't because athletes the session fixation instead. You should be regenerating the session ID when you have a new session started like the first time you generate a new session ID regenerated and use that so then if they have a valid session, it's also with an ID that has been generated and is safe that they should just check. Till here like I don't think it would be a bad idea to just check that path. But if they were regenerating session IDs, this wouldn't be an issue. So\", \"start\": 5512.1}, {\"speaker\": 1, \"line\": \" but so by changing all of these issues you can essentially end up with a web show and the cherry on the cake of this article is the web server runs as root. So you're not did fix these issues. It did take them look pretty long time though. Because if you look at the Timeline, it says these issues were reported in the middle of August last year and they were fixed like middle of December looks like they were\", \"start\": 5675.3}, {\"speaker\": 2, \"line\": \" reported June actually, June\", \"start\": 5700.4}, {\"speaker\": 1, \"line\": \" 14th. Yeah. Sorry June. So June 14th, and then they weren't fixed until December 16th. So it took quite a while for them to be\", \"start\": 5702.0}, {\"speaker\": 2, \"line\": \" fixed. So that could be just that are related to an update cycle. I don't know how frequently qnap puts out updates. But it could be related to that. I don't think like this is mostly like network attached storage devices. At least. That's what I know Q Net for I think they might also do routers, but I know them for their nest devices and this yeah this impacts their nass model. So I don't think that's something that you know has like a six-week update cycle. So it could be related to just their next major revision was to be on this date or they'd already Cold freaks for the next one said have to be skipped one or whatever\", \"start\": 5709.2}, {\"speaker\": 1, \"line\": \" six months of still. It's still a\", \"start\": 5752.7}, {\"speaker\": 2, \"line\": \" long time. I'm just trying to explain kind of a case where that could have happened but it smells like yeah, because I mean this isn't a web app. Well, it is a web app, but it's not it's not like they can just force the patch on everybody.\", \"start\": 5754.6}, {\"speaker\": 1, \"line\": \" Yeah. So the author stated that there is probably going to be more high impact CV he's coming for qnap in the future.\", \"start\": 5769.7}, {\"speaker\": 2, \"line\": \" I mean if they have this issue.\", \"start\": 5775.8}, {\"speaker\": 1, \"line\": \" They probably got these are pretty low hanging fruit. And the he even gives a hint. He's like if you want somewhere to look look at more of that session ID stuff and you probably get more 0 days which indicates that he probably knows of some other issues related to that session ID.\", \"start\": 5777.7}, {\"speaker\": 2, \"line\": \" Yeah third if they do\", \"start\": 5792.4}, {\"speaker\": 1, \"line\": \" that reversal,\", \"start\": 5793.8}, {\"speaker\": 2, \"line\": \" yeah, that is it's a really weird thing to do because PHP does handle sessions for you already the fact that they're trying to write files based on the session IDs just seems really\", \"start\": 5796.3}, {\"speaker\": 1, \"line\": \" weird. Yeah, it's just kind of a it's I don't know if a code spell is the right word for it. But when you see something weird like that, it's definitely calls for like an investigation into it. Yeah, and you end up finding word weird and she's like that. So getting into eliminating 20 year old bugs are actually will not bugs but attacks is a better a better word. So this is a research post put out by checkpoint, which is another group that we cover quite a bit on here and they aimed at killing link attacks through hepatech. So we've talked about Heap attacks in the past and all the like House of X type of attacks. I mean,\", \"start\": 5807.0}, {\"speaker\": 2, \"line\": \" we're just talking about one\", \"start\": 5849.0}, {\"speaker\": 1, \"line\": \" earlier. Yeah, exactly. So, So they aim to prevent one of these types of attacks. So this mechanism isn't just some extension or third-party Fork of Lipsy. It's what makes it notable as is actually being integrated into G lib C for Linux and you see lib C for embedded stuff. So he Pain Link is something they kind of give a bit of background on and it's been a super old attack that was fixed a while ago. It was fixed back in like 2005 but to give a little bit of like context they talked about it a bit.\", \"start\": 5850.6}, {\"speaker\": 2, \"line\": \" Yeah. We'll see. So the unlink attack and that was fixed by something called safe unlinking. So this is safe link the name will come out a little bit more later. But if you're not familiar like linked List have been a common primitive for attacks. We are able to control values in a linked list often when you're freeing it. So like, you know freeing memory ends up. They said one point didn't have a checks on it. But, you know ends up removing an item from our can be removing an item from the link. From a linked list, which requires kind of doing some pointer checks were takes the forward pointer of whatever your you've got your target block. It goes forward pointer that grabs K. What? What's our backward pointer there and sets that too. Now I'm having trouble visualizing it. It's a four-pointer back go. Yeah. Yeah. Well, I mean it's it's removing it. So it's basically going to whatever links were before it and after it and removing Itself by replacing terrible explanation. I\", \"start\": 5883.5}, {\"speaker\": 1, \"line\": \" know it's hard to explain. Well, I think it's kind of weird like\", \"start\": 5947.7}, {\"speaker\": 2, \"line\": \" wingless if you're looking it's literally just forward accessing the back if in the protection it's just checking to make sure it's pay just making sure the forward back and back forward pointers are Name honestly, if I say that that probably makes sense to you if you already are familiar, if you're not they actually link over to Voodoo mellow tricks the frak article that kind of first talked about it worth the read worth the read regardless actually, but it talks about the attack there. But it's just a common primitive or this if you can control those pointers you end up controlling what that back you end up controlling both were worth writing and what it's writing. It gives you an arbitrary,\", \"start\": 5951.9}, {\"speaker\": 1, \"line\": \" right? so like you were saying they introduced a fun linking to try to prevent that and basically what they did was they checked if the forward pointers back pointer equal the current node and after that attacker started moving on as they always do and this time you've gone to single linked list data structures for things like Fast bins and thread crash Fred caches the by corrupting one of those lists, you could basically get an arbitrary Malik because by corrupting the forward pointer of one of the The singly linked list you can control what the next item in the list was and get that to be returned by malloc. So you could make that point anywhere to basically get control of that memory and their new safe linking mechanism tries to prevent that type of attack and they do a few things there. They try to their goal is to prevent partial pointer over right attacks full pointer over rights unaligned chunks and all these on like any of the linked list nodes and they basically use this Do this by making use of ASL Arts Randomness to kind of sign the pointers? So they create a key based on the random bits used for randomizing the Heap to do kind of like a ghetto pointer authentication. This is very reminiscent of like what you've seen with pack with like iOS and stuff like that. It's not exactly similar but it's kind of similar in like how it works.\", \"start\": 5995.1}, {\"speaker\": 2, \"line\": \" It's so clear. So you say they create a key that's not a separate value though. The key is part of the original address. Correct? Just make sure I understood this correctly because my understanding was that the key is where ASL are randomly ends up putting the Heap. Yeah, exactly. Yeah, Rocky. Okay. I'm sorry. Well, you mentioned the key. So I was thinking maybe I miss where they actually do a key generation or something. But yeah, okay. So they reuse that value within the up doing is X or e They shift. The shift the address a bite and a nibble over to the right. So 12 bits I decide to say that weird I guess but they shifted over 12 bits and then X or with the original address and that new result becomes their in coded or they're tagged\", \"start\": 6076.2}, {\"speaker\": 1, \"line\": \" pointer. Yeah, so on and so on this would be pretty annoying to get around as an attacker, but they also went a step further and they verified the alignment and of the pointer so you couldn't do like a partial over right for example or pull off some of the previous tricks like overwriting the Malik cook theof. Aspen is one they mentioned so well,\", \"start\": 6128.0}, {\"speaker\": 2, \"line\": \" so the challenge with that is just you have to point it somewhere that also is aligned like to the same chunk amount. So that limits where you can point it. Doesn't mean you can't do it it just you know is a very significant limitation on where you can point it. So like in the example we've got here. Whatever address you wanted, they would have to have some valve can be exerted by the three. They're like basically the three would have to be included in it so that became zero. Yeah, so like whatever you choose to Target. Needs to be like\", \"start\": 6148.6}, {\"speaker\": 1, \"line\": \" that. So even with these mitigations is always what's the cost in terms of performance? It seems here. It's not that high. They said they only added like three instructions and both malloc and free and they said over I think they said like a billion tests on a virtual CPU on Google Cloud platform. There wasn't even a measurable difference. So this isn't going to entirely kill like keep metadata attacks, but you're going to need an info leaked to get around this mitigation most likely so you can get that like, Signing. Yeah, and I called the signing key basically as a\", \"start\": 6186.3}, {\"speaker\": 2, \"line\": \" yeah, and that's I think is the big issue here or I guess I should say it's that's the way you kind of defeat this and you're probably in a lot of cases already. I'm going to need an info leak in a lot of\", \"start\": 6221.7}, {\"speaker\": 1, \"line\": \" attacks. Yeah, anything heat-based because it's not deterministic enough though. You're going to you're going to need input lag. So that's a good point.\", \"start\": 6236.9}, {\"speaker\": 2, \"line\": \" Yeah, so I mean it is a protection. I it's not going to eliminate the attack\", \"start\": 6245.2}, {\"speaker\": 1, \"line\": \" though. So one thing that was kind of weird though that they pointed out was chromium already does something that's kind of similar to this with TC Malik that they implemented eight years ago. It's in it's in a very similar fashion. They call it pointer masking. It's a little bit less efficient. It doesn't do the alignment checking and it uses additional memory references and it uses more assembly instructions, but it's still not like super high overhead. But like we're saying this is going to be or it is being integrated into Julep see and you see live zi it's going to also be integrated into TC Malik, but I think it's going to be off by default because I think when they submitted it Google because Google is behind he seemed allegory they were kind of like this has too high of a performance overhead, which is weird considering these guys call out TC Malik for already having this but in a less efficient manner you would think there's would be an upgrade to what TC. Alec already has so there is kind of like a\", \"start\": 6250.0}, {\"speaker\": 2, \"line\": \" weird. No, but I\", \"start\": 6309.2}, {\"speaker\": 1, \"line\": \" didn't understand.\", \"start\": 6310.7}, {\"speaker\": 2, \"line\": \" I want to say that the TC Malik One. Is less performant, but does a better job of masking you would need to leak The Mask key itself. I don't believe it uses it like this where you can kind of use an info League to get that information about where it's mounted. I believe with TC Malik it does use a separate\", \"start\": 6313.0}, {\"speaker\": 1, \"line\": \" key. Okay, throw know I might be mistaken about that.\", \"start\": 6334.8}, {\"speaker\": 2, \"line\": \" I am just going off memory because we're talking about now. I didn't look into it. But I believe if you use like a separate key for it. So it is technically less performance, but I think it all for it. Might offer more security that said like said I could be wrong. So, you know, let me know how wrong I am in the\", \"start\": 6338.9}, {\"speaker\": 1, \"line\": \" comments. So to be fair to them in the in the like conclusion their final note. They do know like the safe linking mechanism that they came up with. It's not like us it's not a silver bullet, you know, it's not going to it's not going to cure Heap attacks or anything like that. It's just like an extra step in the chain, which is all mitigations are like, you know, no mitigation is going to be foolproof. So I think it's cool. I really like the concept I like the idea of like taking pointer authentication and trying to apply it without that like Hardware support. I think that was kind of clever in a way. I even though it is kind of easy to defeat if you have an info leak or something like that. I still thought it was clever and this gives some insight into someone like the heat metadata and how it works and how you can attack it. So it's another one of those resources to throw in the Heap exploitation been I\", \"start\": 6359.8}, {\"speaker\": 2, \"line\": \" think. Yeah. I think that using the ASL are like reusing that information is actually kind of a neat idea here obviously like that means it can be broken with, you know, breaking a SLR. But I don't know. I think that's definitely an interesting idea.\", \"start\": 6410.4}, {\"speaker\": 1, \"line\": \" You could take it a step farther and have a key that's generated on Program start. Like if you modified the CRT stub maybe or something and make it so it's initializes a random key and then add yeah, but that bad's Randomness it does that overhead.\", \"start\": 6427.5}, {\"speaker\": 2, \"line\": \" Yeah. That's why I'm saying I do think it's interesting to reuse that Dad generating. He some that's already been done. Like that's not a new\", \"start\": 6442.7}, {\"speaker\": 1, \"line\": \" idea. Yeah. That's true. That being said though move on to more technical papers. So this one is not so fast understanding and mitigating negative impacts of compiler optimizations on code re-sketch. It's so this one dives into code of optimization done by compilers and how it can impact availability of those code reuse gadgets and they said they were motivated motivated by the fact that compiler optimizations. Are there. Usually they're invisible to program. Authors and they also haven't really been explored too much by previous work. So talking a little bit about code reuse for those not too familiar. If you're exporting a binary and you're getting code execution in modern binaries. It's not likely you can just write opcodes into a buffer and execute it, you know, she'll coding isn't super easy anymore. It's kind of dead mostly due to no execute and x and the most common way to abuse code execution nowadays is to use rope chains. So you use a gadget that allows you Pivot to a fake stack that you set up and then you execute you set up a series of gadgets and that fake stack to execute that already exist in the code. And then you execute that in a controlled order to accomplish some goal. So you basically use Rob to build up Primitives that you can use in your payload.\", \"start\": 6451.4}, {\"speaker\": 2, \"line\": \" Yeah. I mean limited the general idea just because they call code reuse is Gary using I think you're just about to hit it this you're reusing code that already exists in the application so Rob Is one example of that job and cop will both to jump oriented and call oriented will both also they're reusing existing code that way even though you've got this no excuse so you can't inject data that gets executed as code. You're reusing all the existing code in order to I do something more useful. So that's code reuse attacks. Let's just try the more generalized name that's been given to the entire classification from like gold red tulip see being generalized up to rock top, which is now kind of just generalized as CRA or code\", \"start\": 6529.2}, {\"speaker\": 1, \"line\": \" reuse. Yeah. So because of that the fact that you're reusing code and gadgets provided by the binary. You're going to be limited based on how the binder is compiled. How much code is in there? R what the code does because the code you you're reusing if you're doing like Rob always has to end in a Rhett opcode or if you're using job. It has to jump or call to a location you can influence so limiting these gadgets is kind of interesting from a defensive point of view because you can make it. So even if your program has bugs that are exploitable for code execution it makes using that code execution a lot more difficult. So there's been more of a focus on that lately and there's various types of gadgets. Classifications you can do four of them. So there's like intended gadgets which are explicitly generated by the compiler and x86. You can have unintended ones because of varying instruction sizes. So you can jump into an instruction Midstream to you know, there's there's sometimes instructions embedded between other instructions that you can abuse but this is kind of a new type that they explore which is optimization induced gadgets. And so basically what they did here was they tested 17 programs and they compiled them with various optimization levels from o 0 all the way up 203 and generally they found a trend where the higher the optimization level they found more gadgets were introduced. So they have a they have a table here on page 7 which I think zi is already brought up here. So they have all the programs on the left and then you can see like oh one for BF T PD 683 and then O3 781 so as the optimization Go up. I think it basically every case the amount of gadgets go up which is kind of interesting. So they almost specifically\", \"start\": 6581.2}, {\"speaker\": 2, \"line\": \" with O3 they had a large gain, but you'll notice like if you look at G zap, it actually drops with a Wanda. No to goes actually othrys down on that one else. Maybe that's a bad example, but live lipsey or L. That one drops with o 1 and o 2 and goes up with oath. Three and they talked about the fact that O3 seems to introduce a lot of vulnerable\", \"start\": 6686.4}, {\"speaker\": 1, \"line\": \" gadgets. Yeah, so when they root cause it they found three mechanisms that were primarily responsible for generating all these additional gadgets. One of them was duplication of instructions that produce gadgets and that's because compilers with at optimization level 3, not any lower. So this is one example of what zi was talking about they can selectively duplicate code to increase performance at the expense of file size. And you know, you've seen I seen that in other areas as well like games commonly do that with a assets as well way, you know, it doesn't have to make that call it can just you know duplicate that code and it's right in there. So it makes the performance down a little bit or sorry. It takes a performance up a little bit because it takes the time to execute down a little bit but that's only employed at the O3 level. The other thing that caused a lot of gadgets to be creative was clangs tail call elimination that will optimize functions which call another function at the end it just Squee makes it so it replaces the call with a jump. So that has slightly lower overhead because a you know call has to do stuff with the stack and whatnot jump can just jump it just switches the instruction pointer. That's\", \"start\": 6714.6}, {\"speaker\": 2, \"line\": \" yeah in particular that's tale called recursion its particular off my zation if you're kind of familiar with\", \"start\": 6787.1}, {\"speaker\": 1, \"line\": \" that. Yeah. So what this code does is it generates or what this optimization does is it generates code to restore the preserved registers and then it just jumps to another register which contains where you want to jump to and this creates a super useful jump oriented programming gadget called the job data loader because basically it loads registers with controlled values from the stack because it's just popping from the stack. So if you control where the stack points you can get controlled values into those preserved registers and then it can jump to a controlled location as well. It's a very powerful primitive for for jump oriented programming.\", \"start\": 6793.5}, {\"speaker\": 2, \"line\": \" Yeah. It's also kind of want those necessary ones because you do need like for Java tax you do need to have some Gadget that provides you that register control and jump control C like you need that jump table\", \"start\": 6829.7}, {\"speaker\": 1, \"line\": \" access yeah it's not it's pretty rare that you get control of a lot of the registers at time of like code execution sometimes you do like I've exploited cases where that's absolutely the case and we didn't need it that a little Gadget but yeah in a lot of cases it's at least a nice to have you might be able to do without one but it's a lot easier if you do have one and then the other mechanism was transformative gadgets and this was just due to like layout changes and offsets and relative jumps so for example if you had like a relative jump the jump to something and then it ended off with hex C3 is the example they gave that's going to introduce a hex C3 which is a ret opcode for people not familiar with x86 so that introduces more of those mid instruction stream you know unintended gadgets being created So, you know overall it's kind of a mix of things at all optimization levels that result in more gadgets being created mostly it O3 like zi was saying earlier so long with these observations, they did propose a mitigation other than just not using optimization\", \"start\": 6842.0}, {\"speaker\": 2, \"line\": \" before we go there. Actually, I do want to talk about the little bits like the results here of just that initial study. Now, I'm going to be honest. I actually didn't really care much for their mitigation. Wait, as you're saying is it's a binary compiler. They have their own intermediate representation that they lift to rewrite and then compile back better approach. I think is incorporating with like llvm or with clang or DC incorporating with the compilers to fix something bad code. No, it's lock recompiling with that said jumping back on.\", \"start\": 6909.4}, {\"speaker\": 1, \"line\": \" Some of the findings that I did find interesting\", \"start\": 6950.4}, {\"speaker\": 2, \"line\": \" one of the things they talk about are the functional Gadget said expressivity. Basically just how useful are the gadgets that actually were existing. Which I just thought it was interesting to see a laid out here. I pulled the table off on page 8 just seeing how so these numbers displayed if you're watching. First number is the number of full Rock chains. Second number is what they called a SLR proof rope chains, which I find. I feel like maybe I don't understand what they were going for with that because I would imagine that the number of rough practical Rob chains versus the number of a SLR proof. Rob Chains would be like if it's a SLR proof. I'd imagine fewer than the number of total Rob chains, but apparently it's always higher so I'm not\", \"start\": 6953.2}, {\"speaker\": 1, \"line\": \" sure what they mean by that.\", \"start\": 7006.0}, {\"speaker\": 2, \"line\": \" Yeah, and I couldn't find what they really meant by that either. They do link off some other papers that I didn't look into and then last one is just is is it A turing complete they have Turing completeness. so like you could do basically any computation then\", \"start\": 7007.1}, {\"speaker\": 1, \"line\": \" which to be fair I I don't necessarily agree like there's a lot of white papers when they're talking about Droppin stuff they put like this huge like emphasis on Turing completeness as if it's like the gold standard of how useful or how many gadgets exist or whatever like that like you're never going to need turing-complete Rob chain capability like you just don't need it you're doing such simple Primitives that as long as you can do like a few basic operations you can\", \"start\": 7022.3}, {\"speaker\": 2, \"line\": \" only sounds like a CTF challenge idea you have I mean it's fair because that is one of the few ways to actually measure how like if you meet the Turing completeness you can do any sort of computation now I agree that it's not necessarily it's not necessary in most cases but it is one of the few measurements that you have that's objective\", \"start\": 7050.7}, {\"speaker\": 1, \"line\": \" yeah it's a set in stone measurement like it's not there's no subjectivity on it so that's fair but yeah just one of those things where I think there's too much emphasis placed on it\", \"start\": 7078.9}, {\"speaker\": 2, \"line\": \" nonetheless I just want to kind of pull it up here that it was interesting just Look at the results of this of their how expressive the gadgets were or at least how would they how expressive they thought they were? just how changes there and I mean it is more or less what you expect is clang seems to introduce more gadgets Gadgets in general similarly here, you know, they're also more expressive Gadgets in general or there are more expensive gadgets, but I did want to point out they did take a look at that, which I thought was an interesting approach because the last time so we actually we did talk about code reuse attacks and the impact not of compiler optimizations but of Just reducing attack surface back in episode 13. We talk about a paper measuring attack surface reduction in the presence of code re randomization. Which focused on how many gadgets were available. So that was obviously a different approach at preventing the gadgets which had some very interesting techniques. They're actually worth going back and listening to us on that now that I'm thinking back about that one. It was a good it was a good paper but this one kind of reminded me of that and I kind of like this approach of looking at how expressive those gadgets are versus just how many gadgets there are which is what the other\", \"start\": 7088.8}, {\"speaker\": 1, \"line\": \" paper I'd done. Yeah, overall. I found this to be an interesting paper. I do want to say like kind of like what you were saying earlier with that aslr proof stuff. It does seem like they have a lot of terms and stuff like that that they don't really clarify. They just kind of use them and expect you to know what they mean.\", \"start\": 7172.1}, {\"speaker\": 2, \"line\": \" Well if they do, I believe they do cite other papers as they first use them though. But so I believe\", \"start\": 7191.1}, {\"speaker\": 1, \"line\": \" that like I shouldn't have to read other papers to see what they mean by the terminology if it's not commonly known like here's another example, they say functional gadgets set. But like functional Gadget like it's just it seems kind of buzz wordy. And when I tried to see what they were meaning by that there just wasn't really much there. It was kind of vague on what they were talking about their so there are two\", \"start\": 7198.7}, {\"speaker\": 2, \"line\": \" examples of that. We do kind of mention it over here on page 5 where they talk about the functional Gadget said expressivity and how they measure Something with that\", \"start\": 7221.4}, {\"speaker\": 1, \"line\": \" but like where do they Define it? Like first? They just say like functional gadgets that like, it means\", \"start\": 7233.7}, {\"speaker\": 2, \"line\": \" something this is where there is kind of defining\", \"start\": 7238.6}, {\"speaker\": 1, \"line\": \" Act. I mean, I don't know that doesn't really seem very clear on what they're actually saying. They're I don't know maybe it's just me. But but anyway, like that was just something I kind of noticed that the paper I'm not trying to fog on the paper though. Like I did find it interesting paper.\", \"start\": 7240.7}, {\"speaker\": 2, \"line\": \" And yeah, I found the first part interesting. It was like said the recompilation aspect I didn't care for\", \"start\": 7256.5}, {\"speaker\": 1, \"line\": \" yeah, it's something I hadn't really considered optimizations really having a big impact on so it's kind of cool. It's kind of like a PSA and I regard you know, that's something I'll probably keep an eye on then again keeping my mind while I'm looking at stuff in the future\", \"start\": 7263.4}, {\"speaker\": 2, \"line\": \" to some extent to me unless you're writing the code. It doesn't really matter.\", \"start\": 7277.3}, {\"speaker\": 1, \"line\": \" No, that's true. And right here if you write your\", \"start\": 7281.7}, {\"speaker\": 2, \"line\": \" code without any vulnerabilities, it doesn't matter right? Anyhow,\", \"start\": 7284.4}, {\"speaker\": 1, \"line\": \" just write things in Rust but I'll be honest outside of security. I find myself disabling optimizations on compilers a lot just because in weird scenarios, you can get bugs created by optimization as well. Like I recently had to try to help debug an issue related to Loop unrolling causing like a ton of issues in something. So it's like optimizations. I just don't like them like, you know leaving this paper assigned pretend I never saw this paper. I just don't use optimizations because they're doing stuff behind the scenes that you're not going to be able to easily tell as the program author and you have to go digging like reverse engineering your own binary to see if the compiler screwed you over somewhere so You're going to\", \"start\": 7288.4}, {\"speaker\": 2, \"line\": \" just write everything in assembly. Then you always know what the output is.\", \"start\": 7333.5}, {\"speaker\": 1, \"line\": \" Yeah. Basically I'm just going to head right everything. No. I'm okay with unoptimized like compiler output. I think when you start going to the optimization levels though, there's a lot higher of a chance of you getting bugs that aren't necessarily your fault. Yeah.\", \"start\": 7337.6}, {\"speaker\": 2, \"line\": \" It's worth being aware of that and I think a lot of developers like eventually you always get bit in the ass by that. you know it does happen with optimizations and just you know recompiling it with you know o0 and testing to see if your bug still happens is one way to kind of see if that's the issue rather than just looking at the disassembly that's not always so easy but\", \"start\": 7349.8}, {\"speaker\": 1, \"line\": \" the only other thing is I may sound like a broken record here but I wish there was a more diverse program selection for testing like if you look at their test tables and stuff you cgcc gzip httpd lib sqlite we see these in like every paper and again like it's something I've said before these are not programs that are really targeted for exploitation very much I want to see more of these tests being conducted on on targets that are being hit more like you know browsers or\", \"start\": 7378.8}, {\"speaker\": 2, \"line\": \" yeah I mean that's the Benchmark choice and with that\", \"start\": 7408.9}, {\"speaker\": 1, \"line\": \" we've I don't have this choice I just disagree with it\", \"start\": 7411.7}, {\"speaker\": 2, \"line\": \" no no I'm just saying like we've definitely had this discussion a few\", \"start\": 7414.1}, {\"speaker\": 1, \"line\": \" times yep no I know I just wanted that said\", \"start\": 7418.4}, {\"speaker\": 2, \"line\": \" identify appreciate that first they actually did use like I don't think a lot of these are necessarily the normal choices I mean bzip2 GCC those are normal but SQL Lite I don't think something we normally see and SQL lights definitely sound that does get attached some degree because it is is like SQL like database is already use quite frequently specially on my mobile devices httpd gzip we were talking about if I mean it wasn't really attacking gzip but it was attacking the output of gzip just last episode lip curl that's fairly popular I mean I use Curl to download all of the PDF so we can show them on here so I mean it's some some of those are attacked and I those it's basically those first ones and then I think everything after that the bzip GCC I'm CF I think those came from Psalm\", \"start\": 7421.7}, {\"speaker\": 1, \"line\": \" benchmark to be fair it's add them to the they were like trying to compare to like previous papers and stuff and if those papers use the same benchmarks I can see why they would want to keep it consistent so\", \"start\": 7482.1}, {\"speaker\": 2, \"line\": \" yeah I know that I'm just saying I don't think the first ones there like the first six are bad choice\", \"start\": 7494.4}, {\"speaker\": 1, \"line\": \" Turn off\", \"start\": 7502.1}, {\"speaker\": 2, \"line\": \" like a even get I mean people do use get so that is something that could be attacked. I mean it actually we've talked about a remote get thing or was it may be specific to GitHub or gift lab\", \"start\": 7503.0}, {\"speaker\": 1, \"line\": \" there was there was a good issue but it was in the credential helper\", \"start\": 7516.5}, {\"speaker\": 2, \"line\": \" right? Say yeah, I would leak that information. Yeah. I don't know. I mean, I feel like those are actually Fair choices like those are common. Applications the only one that I'd have some questions are like Jesus common. I'm not questioning that but for targeting youth like I think those are things that do actually get targeted.\", \"start\": 7520.0}, {\"speaker\": 1, \"line\": \" to move on to our last paper which is precise xss detection and mitigation with client-side templates so this proposes a client-side excess solution called X snare so we've seen some client-side xss mitigations before notably Chrome used to have one I don't think they have it anymore they got rid of it\", \"start\": 7542.5}, {\"speaker\": 2, \"line\": \" all the exes auditor is being removed I'm not sure if it's\", \"start\": 7560.1}, {\"speaker\": 1, \"line\": \" gone still not removed holy crap I don't use Chrome anymore so I wasn't totally sure on that anyways it seems there's tries to break off from some of the ones we've seen in the past by trying to be more precise you know not just having a catch-all so it seems how they try to do this as they scan the Dom of incoming web pages through a browser extension\", \"start\": 7564.4}, {\"speaker\": 2, \"line\": \" okay just for in sorry to interrupt you but it has been fully removed as a problem 78\", \"start\": 7586.7}, {\"speaker\": 1, \"line\": \" Okay cool so yeah it tries to scan the table of incoming web pages for injected content by comparing it against the template of it content through signatures so and then tries to manually sanitize it so for doing that like I said it relies on signature it's kind of like an antivirus in a way through the browser - I think is the\", \"start\": 7592.3}, {\"speaker\": 2, \"line\": \" problem it's like an anti-virus obviously antivirus can also do some heuristics and stuff but it uses these signatures it would so I pulled up the one example they have here and X their signature in the paper on WordPress admin request and you provide like the endpoint so looks between like this tag and the next label and there are like the label tag And for that for there to be some injection in there some HTML code. So one of the immediate problems that I see with that is if you're aware of the signature, you can get around it trivially by including the end Park. It's similar dump. They actually use I believe they used on purify the idea here though. Is that This isn't done by the application developers. This is something I would run in my browser like you block or Jane or something. I would run this as an extension on my browser, which is a hole which is another issue that's going to impact any sort of potential adoption and then they can write these signature. So the way I could see this having actually had a chance at working is If This Were a commercial offering if there were a company offering this set actually had analyst higher or if this were part of an anti virus if Were acquired by an anti virus who then if their own because a lot of anti viruses do have that internal protection. Yeah, they have their own extensions. So then if they added this into that I could see this working where you have analysts that are going to write these excess detection signatures. And then yeah, you can use I feel like Dom purify like, I believe they offer that as a As one of the options that like as want the sanitizers, I I mean I can't and for anybody just listing their ex. Thhle mentioned isn't the stone purifying chat. I didn't mention that there's chat. But anyway, I do think the issue one. It can be it seems like it can be trivially bypassed if you know about the signature because you can just go ahead and inject that label class equals description in this case is what it's looking for at the end. And you just inject that as part of your injection and suddenly everything looks okay to it. And then you put your excess after that. That would be one case of doing it. Obviously you need to be aware of the signature. The other thing is it's possibly to specific they use the present that as their advantage. It's a where it's application-specific these are written for specific application. That's it's unlike WP Dash admin you can remount that where you want. I believe you can put that on another URL and then it's not going to work for that domains WordPress. Admin. if you move that BPM, and so their issues like that, I\", \"start\": 7613.5}, {\"speaker\": 1, \"line\": \" just It's\", \"start\": 7794.8}, {\"speaker\": 2, \"line\": \" I don't even want to say it's a fun idea. Like it's just the wrong place to focus. So but my thoughts on\", \"start\": 7799.3}, {\"speaker\": 1, \"line\": \" this here is I think it's nice that is trying to tackle it from the client side because it's just one of those like xs/s is one of those things. You just can't trust the server side like, you know web admins and stuff to eliminate it. They're just they're going to be around forever. So I think it's worth trying to tackle it from that angle my problem with it though is with Being signature-based it's going to require so much manual labor because in their testing they tested they wanted to test a hundred cdes in WordPress. And this was kind of weird to their testing results. They said they were going to test a hundred cdes then they said they could analyze 81 but then they said they'd drop 24 due to reproducibility issues. So they actually ended up testing 76 so of the 76 that they ended up testing they were able to detect a seventy one of them using 59 signatures now these signatures took like under 10 minutes or so to write but those start adding up when you're talking about 60 signatures. That's you're talking about. Like let's say it took 10 minutes per signature, but that's 600 minutes just into writing signatures for one thing and you're not even catching all the issues. I think there's too much manual labor involved for not enough benefit. Yeah, I'm back there needs to be a commercial offering because if it's a free offering there's just not going to be an incentive for people to write\", \"start\": 7807.5}, {\"speaker\": 2, \"line\": \" signatures. Well, that's the other thing with that's where you can also point out how intensive writing signatures for malware can be to for antivirus has to do the signature detection on malware you can kind of point to a similar problem the difference is the malware signature it runs a kind of a last line it's like right before your computer or even as your computer is actually executing the malicious software but it because of that any attack service that results in it can be caught by the signature where as this the signature is specific to a particular application Oh that kind of limits. I think how often any of these are going to be abusable or how often this thing's going to be able to catch all of those of you says at least the payoff for doing it with an anti virus is a continued protection\", \"start\": 7886.0}, {\"speaker\": 1, \"line\": \" against anywhere that\", \"start\": 7943.5}, {\"speaker\": 2, \"line\": \" malware appears now granted. It's trivial enough to craft new malware. It's a lot less trivial to do malware signature. Yeah of chatter. Sing a significant portion of malware signatures can just be bypassed with bit flips and like and yeah, it's really trivial to bypass malware signatures at a single instance or for single moment to like just build something that's new and unseen. It's not too difficult. It's more difficult to remain unseen for any significant period of time though. which is kind of noteworthy point because usually you know a lot well maybe not usually but a lot of malware is going to be trying to a target a lot of people and get as many infections as possible so yeah the first time you run something if you're like a pen tester you need to get around in antibes are super easy because you only need in fact like one person or you know a handful of people when you start getting up into the thousands though it becomes a little bit harder to stay undetected the entire time there are ways to do that too I'm not saying it can't be done I think just a little bit harder you do have the payoff for that particular malware's no longer going to be effective I feel like the payoff is better than the payoff for doing one of these excess things which is like okay if you get some like WordPress the payoff might be higher but not every site is going to be the same like\", \"start\": 7945.9}, {\"speaker\": 1, \"line\": \" that And that's the other issue is like it's too specific because something like WordPress is a good Target. Like it's a good Target the tests with their white paper because there's lots of websites that use WordPress that use plugins and stuff like that and WordPress plugins are notoriously bad for like having low hanging fruit issues. So something like this is really good for WordPress type sites, but for other sites that are just running like, you know their own stuff. You're going to have to add an unreasonable amount of signatures into that though. I just it doesn't really scale. Well, so I think this is just another one of those papers where in practice when you're writing it down. It sounds like it an okay idea, but when you actually try to scale it and you try to put it out in like real world situations, it's just it's kind of Dead on Arrival. It just requires too much\", \"start\": 8032.4}, {\"speaker\": 2, \"line\": \" manual. Yeah. I mean, it needs commercial backing if it had commercial back. There is some promise at least the idea as long as they combine that with the more generic cross-site scripting and I mean we've already seen how that didn't really work out for Google try to do the excess auditor oh still pretty easy to\", \"start\": 8083.9}, {\"speaker\": 1, \"line\": \" bypass yeah totally GitHub repos of full of lists of how to bypass\", \"start\": 8102.4}, {\"speaker\": 2, \"line\": \" it yeah and I imagine that would be the same thing with something like this to like say if you're aware of the signature you can get around it so it just becomes a earliest it seems like granted I haven't run this to actually test what I said but my understanding of it what I mentioned earlier for getting around it I believe would work so if you were if you ran into it oh it's blocked okay let's just what signature let's just change it really quickly and it just it's Kat that was back and forth\", \"start\": 8108.0}, {\"speaker\": 1, \"line\": \" there is kind of an interesting angle that I want to bring in from the excess auditor from Google and see if it kind of applies here or if you think it applies here the one argument I heard a lot about access auditor was people didn't like it because it made server admins and web admins take xss less seriously because they'd be like oh there's an xss but Chrome Auditors are Chrome xss Auditors going to block it anyway so it's not an issue we're not going to fix it and that was kind of it was kind of providing like that false sense of security because It was easily bypassed but it's you still weren't getting fixed because server owners acted like it was bulletproof and I could see that argument could kind of be used here as well. I don't know if it applies at here as as well as it did with excesses auditor. I don't know what your thoughts are on\", \"start\": 8136.8}, {\"speaker\": 2, \"line\": \" that. I don't think it really applies here because you need the issue needs to already be getting exploited before they can write a signature.\", \"start\": 8184.2}, {\"speaker\": 1, \"line\": \" Okay.\", \"start\": 8193.6}, {\"speaker\": 2, \"line\": \" Yeah, and I mean we talked about that. Excess auditor and the admin aspect when we I believe when we announced the excess auditor was being removed. I believe we did talk about that on an\", \"start\": 8194.7}, {\"speaker\": 1, \"line\": \" episode. Yeah. I kind of wish I went back and got the episode number for that because we had some interesting discussion around that and that would tie in really well here but I don't have the episode on hand. I don't know if you're trying to look for it.\", \"start\": 8205.0}, {\"speaker\": 2, \"line\": \" I'm trying to look for it, but I don't\", \"start\": 8218.1}, {\"speaker\": 1, \"line\": \" have it on hand. It probably wasn't a headlining discussion. So it might not be like in our title or anything like that so it might be a bit harder to find anyway yeah this is just one of those papers where I think the idea was like kind of neat like let's see if we can move what any buyers is doing to web it but without commercial backing it's just not I don't think it's good\", \"start\": 8220.2}, {\"speaker\": 2, \"line\": \" and I mean I guess it's fair not to expect commercial backing from research it's just like it it's as your kind of mentioning its some that just doesn't scale and that's kind of difficult\", \"start\": 8243.5}, {\"speaker\": 1, \"line\": \" for also backing it wouldn't scale well that's the problem\", \"start\": 8257.3}, {\"speaker\": 2, \"line\": \" well I mean it would scale as well signatures do for antivirus little bit worse I think but\", \"start\": 8260.4}, {\"speaker\": 1, \"line\": \" so that being said we'll move on to some shoutouts I know you have one Z another Port Swagger one do you have one I have one do you want me to get to mind while you look for the\", \"start\": 8268.8}, {\"speaker\": 2, \"line\": \" know I've got I've while we've already got the excess one up here yeah supports wicker put out some that I thought was interesting with a put out here with some Labs that they call the impossible lab so if you're not familiar Port Swagger guys behind burp which if you've done any sort of web testing you're probably familiar with and they also have the port's Wicker Web Academy which has several labs are you to learn different techniques different attacks so with this documenting The Impossible and exploitable access Labs these are Labs that they have a vulnerability in them but as far as they are aware can't actually be exploited so the idea here is rather than try to list like all these different exploit techniques for you to try which no wasp has a pretty good list of that what they're trying to do here is if you have this situation like this first one here where you can't use an open tag followed by an alphanumeric character that's the restriction on it if you'd like you can do everything else in just your basic HTML contacts but you can't use alphanumeric character after an open\", \"start\": 8280.0}, {\"speaker\": 1, \"line\": \" tag\", \"start\": 8353.8}, {\"speaker\": 2, \"line\": \" and in this case all of these Labs can't be explained so you can kind of pattern match with if you're in a situation where you have this where you know laugh is blocking the request because of that tag you can be reasonably confident that nobody else has a solution to this either nobody else is going to be able to exploit that scenario in this case like they do mention that the only know one exploit on it is using a old IE with you putting a percent before the alphanumeric part of the tags but they have some other cases here I won't walk through all of them I just thought it was interesting to have a list of that sort of unexpected why double scenarios is sometimes you do run into that where you've got something it seems wrong but you can't figure out how to exploit it and you know may just be the case that you can't exploit it so I guess mr. bugs yeah well and waste so much time trying to figure it out only to realize you can't see I thought it was an interesting\", \"start\": 8356.0}], \"speakers\": {\"1\": \"Specter\", \"2\": \"\"}, \"offset\": \"7\", \"youtube\": \"iNCr4kfZy7A\"}\nTRANSCRIPT--><!--kg-card-end: html-->","authors":[{"name":"zi","slug":"zi","profile_image":"https://dayzerosec.com/content/images/2020/04/zi_head_transp.png"},{"name":"Specter","slug":"specter","profile_image":"https://dayzerosec.com/content/images/2019/11/specter-1.png"}],"tags":[{"id":"5dc68a9598d37b0001178106","title":"Podcast","url":"https://dayzerosec.com/tag/podcast/","path":"podcast"}]}},"context":{}}